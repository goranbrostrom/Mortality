\documentclass[a4paper,11pt,titlepage]{article}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{float}

\usepackage{epstopdf}
\usepackage{url}

\usepackage{natbib}

\bibliographystyle{apalike}
%\bibliographystyle{plainnat}

%\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}
\newcommand{\R}{{\bf R}}

\usepackage[tablesonly]{endfloat}
%\usepackage[figuresonly]{endfloat}
%\usepackage[tablesonly]{endfloat}

\renewcommand{\efloatseparator}{\vfill}

% patch \efloat@iwrite to use \protected@write
\makeatletter
\renewcommand\efloat@iwrite[1]{%
   \immediate\expandafter\protected@write\csname efloat@post#1\endcsname{}}
\makeatother

\author{Sören Edvinsson\footnote{email: \texttt{soren.edvinsson@umu.se}} and
Göran Broström\footnote{email: \texttt{goran.brostrom@umu.se}}
     \\
Centre for Demographic and Ageing Research ({\sc Cedar})\\
Umeå University, SE-90187 Umeå, Sweden}

\title{Long-term perspectives of social inequality in mortality among
  adults and elderly in northern Sweden 1851--2013\footnote{Paper presented
    at the
    session 'Health and Mortality in Arctic Populations'. The Ninth International
    Congress on Arctic Social Sciences,
    Umeå,
    June 8--12, 2017}}

\date{May 31, 2017}


<<setup, include = FALSE>>=
library(knitr)
opts_chunk$set(engine='R',dev='pdf',fig.path='figs/slide-',tidy=FALSE,fig.height=3.5,fig.width=8,strip.white=TRUE,cache=TRUE,echo=FALSE,message=FALSE,comment=NA,show.signif.stars = FALSE,fig.pos='ht')##$
library(knitr)
library(eha)
library(xtable)
library(skum)
@

<<readalldata>>=
## Load remote data:
con <- url("http://capa.ddb.umu.se/data/vb0.rda")
##load("data/vb0.rda")
load(con)
close(con)
vb0$hisclass[is.na(vb0$hisclass)] <- 4
vb0$hisclass <- factor(vb0$hisclass, labels = c("elite", "middle", "worker", "NA"))
##
con <- url("http://capa.ddb.umu.se/data/vb.rda")
##load("data/vb.rda")
load(con)
close(con)
##
con <- url("http://capa.ddb.umu.se/data/lisaold.rda")
##load("data/lisaold.rda")
load(con)
close(con)
##
con <- url("http://capa.ddb.umu.se/data/loTab.rda")
load(con)
close(con)
loTab$period <- factor(loTab$period)
##
vb0Tab <- aggregate(vb0[, c("event", "exposure")],
                   vb0[, c("sex", "age", "period", "cohort",
                          "urban", "civst", "hisclass")],
                   FUN = sum)
vb0Tab$age <- factor(vb0Tab$age)
@

\begin{document}

\maketitle

\begin{abstract}
A long-term perspective on the development of social
inequalities in mortality in the adult and elderly population is taken in
this paper. The area under investigation consists of the Skellefteå and Umeå regions in
the north of Sweden, and the time period is 1851--2013. The outcome is all
cause mortality and cause specific mortality for the categories
cardiovascular diseases and cancers. The analysis of inequality is based on
three social classes, reorganized from {\sc Hisclass}.

The main findings are that a consistent social gradient implying better
survival for classes with more access to economic and other resources, only
become evident in the later half of the 20th century, with lower classes
having the highest mortality. The class patterns in mortality differed
however depending on gender. Women of higher classes were comparatively
favoured in most of the studied periods, while higher class men were
disadvantaged when it comes to survival at least until the middle of the
20th century. The modern pattern of clear socio-economic differences
appeared surprisingly late. Additional and alternative analyses based on education and
income categories confirmed large inequality in mortality
between different groups during the most recent decades. There were no clear signs of qualitative differences depending on whether it was the working-active or the retired population that was analysed, but the differences according to social class was larger in the first-mentioned group. Both cardiovascular diseases and cancers conform with the pattern already observed when it comes to all-cause mortality.

\end{abstract}

\tableofcontents

\newpage

%%{\huge Här ska 'intro.tex' in !!!!!!!!!!!!!!!!!!!!!}

%%\subsection{Combining the data sets and tabulate}


\section{Introduction}

One of the central aspects of survival is social class and access to economic and other resources. Even in present-day welfare societies, social position is a strong determinant when it comes to health and mortality and the impact even seems to be increasing \citep{kuetal04, frlu07}. It has been suggested that “… social conditions have been, are and will continue to be irreducible determinants of health outcomes and therefore deserves their appellation as ‘fundamental causes’ of disease and death” \citep{liph95}. For a long time, the general view has been that socio-economic health inequalities were high in historical societies, probably higher than in modern societies. This is a reasonable assumption since these societies were in most cases characterised by very large differences between groups and classes. Knowing that access to resources provides advantages in all ways, the health advantage of higher classes ought to be obvious. \citet{ant67} and \citet{smi83} suggest that social inequality in health has passed through different historical phases. According to them, social health differences were comparatively small during the pre-transitional phase when space was a strong determinant for the spread of disease. Differences then increased during the transitional phase when mortality declined and wealthy groups used their resources to gain better health. Finally, health differences decreased again in modern low-mortality settings when instead health-related behaviour became important, resulting in marginal differences. \citet{omran82} state, in the third proposition in his theory of the epidemiological transition, that even if the class differential in mortality was maintained during the transition, the decline set in earlier and was faster among privileged groups. 


Recent studies, investigating social inequality in health and mortality with micro-data, has however questioned how generalizable the assumed pattern is \citep{bevp11}. Instead, some studies suggest that the modern pattern might be a fairly recent development, although the pattern differs depending on age, gender or historical context. When it comes to the adult and elderly population results from different studies have diverged, some reporting substantial differences but many, particularly those based on Swedish data, have found surprisingly small or even reversed socio-economic differences during the first stages of the transition \citep{bedr11, edli11,edbr12}, sharply contrasting against what we know from present-day society. 

Another question of the development of social inequality in mortality, concerns its relation to economic inequality. \citet{wipi09} argue that income inequality has an independent effect on mortality, separate from the direct effect of actual different access to economic resources. They argue that unequal societies perform less well when it comes to health than equal ones. Wilkinson and Pickett find a positive association between inequality and health (as well as other social conditions) at country level in the present-day economically developed world. This has initiated a vital scholarly debate and the topic has been extensively studied \citep{suka04, wado00}. How the association looked like in previous periods is unknown. This is of particular interest since the levels of economic inequality were very different from those of the recent decades. Even if it not a necessary implication, we would still assume that poorer groups were those most disadvantaged of large inequality in itself. The situation during the 19th century is uncertain, but at least during the late 19th and early 20th century both income and wealth distribution was strongly skewed in Sweden. From a couple of decades into the 20th century, income and wealth inequality continuously diminished to reach a low point at around 1980. Thereafter, economic inequality has increased substantially until the present, although far from being as high as a century ago \citep{rowa08, rowa09}. The Swedish development resembles that of other European and North American countries in its basic features \citep{rowa14}.

It thus appears as if a more consistent social health divide appeared at some point during the mortality transition, at least in Sweden. Solid empirical evidence about the process is however lacking and studies focusing on the issue are still few. There is a need for more reliable studies from different geographical and historical settings as well as according to age and gender in order to better understand the role of socio-economic conditions for health and survival over time. 



% This paper is a follow-up of an earlier paper \citep{segb16b}, presented at
% the ESHD Conference in Leuven, Belgium, 2016. Here we make a quick look back
% in time for the Skellefteå region (1851--1900), and we also consider causes
% of death from the early 20th century. The {\sc Lisa} data (Swedish population registers) allow
% us to study the effect of income and education on mortality in a more
% direct way for the period 1990--2005, and to compare it with the results of the class-based analysis.

\section{Aims and questions}

In the present paper, we take a long-term perspective on the development of social inequalities in mortality in the adult and elderly population. The areas under investigation are the Skellefteå and Umeå regions in the north of Sweden, and the time period is 1851--2013 for Skellefteå and 1901--2013 for Umeå. The main question we investigate is if inequality in mortality between social classes increased among the adult and elderly population, primarily benefiting the highest social positions and how this is connected to the development of economic inequality in society. This issue is then analysed according to gender, age-group (working age vs retired) and cause of death (cardiovascular and cancer). Furthermore, we compare our results witn analyses of alternative inequality indicators, education and income for the period 
1986--2013.

% ? :
% 
% \begin{enumerate}
% \item Has inequality in mortality between social classes increased among the adult and elderly
%   population, primarily benefiting the highest social positions and how is it connected to the development of economic inequality in society?
% 
% %%\item Is the mortality transition initiated by a certain social class?
% 
% \item Are there any gender differences in the effect of social position?
% 
% \item Is social position equally important among the retired population as for those in working age?
% \item Is there a difference between classes in mortality from cardiovascular diseases and cancers respectively?
% \item Do class inequalities in survival correspond to those depending on level of education and income categories for the period 1990 on-wards?
% \end{enumerate}
% 
% 



\section{The Skellefteå and Umeå regions}

% Figures~\ref{fig:mapp} and~\ref{fig:SKEUME}
% show the study areas and their position in Sweden.



% \begin{figure}
% \includegraphics[height=19cm]{myfigs/skum}
% \caption{The Skellefteå and Umeå regions.}
% \label{fig:SKEUME}
% \end{figure}

\begin{figure}
\includegraphics[height=19cm]{myfigs/sweden}
\caption{The Skellefteå and Umeå regions in Sweden.}
\label{fig:mapp}
\end{figure}

The Skellefteå and Umeå regions (Figure~\ref{fig:mapp}) are part of the county of Väster\-bot\-ten in the north of Sweden along the coast of Gulf of Bothnia. This was a remote part of the country, where communication with the rest of Sweden was difficult until the late 19th century. The economy was dominated by agriculture, making it vulnerable to harvest failures, and several severe famines affected the regions during the 1800s. One living long in memory was the famine of 1867–-1868 \citep{segb14}. During the long winters, sea communication was hindered due to the Gulf of Bothnia being frozen. The first ships during the year came to this area in May or even as late as June in some cases \citep{fah56}. Towards the end of the 19th century, the Swedish railway system reached this part of Sweden, thereby facilitating contacts with the rest of Sweden, improving the economy and mitigating the effects of harvest failures. The inland was particularly remote and isolated. During the 19th century, our regions became increasingly integrated in the same epidemiological pattern as the rest of Sweden. Diseases reached to places that earlier were spared.

The Skellefteå region until the 1950 in our dataset consists of a selection of parishes surrounding the town of Skellefteå, founded in 1845 but with a very small population during the 19th century. The data from the period after 1960 cover the Skellefteå and Malå municipalities, the same area as for the earlier period but with the addition of two more parishes. The majority of the 19th century population lived in rural villages and hamlets, getting their livelihood from agricultural production. During the 20th century, industrialisation took place, partly by the opening of mines in the in-lands. This also led to a population increase both in the town and in the rural parts, and a much more diversified economy.

Mortality was fairly low in comparison with other parts of the country and the fertility transition was late \citep{coa86}. The Skellefteå population size as defined in our data sets was 16\,473 on January 1, 1850, 41\,352 on January 1, 1900, 61\,938 on January 1, 1950 and 76\,723 at the end of the century.

The Umeå region in this study consists of Umeå urban and rural parish until 1950, and from 1960 onwards of Umeå municipality when another three parishes are included. This region has a somewhat different character from that of Skellefteå. Umeå town had a small population but was substantially larger than Skellefteå town during almost the whole studied period. It was the administrative centre in the county of Västerbotten. Schools and military regiments were placed here and the economy was more diversified compared to Skellefteå. Agriculture dominated the rural part, but there were also some foundries as well as industries for example in forestry and small-scale production. The population size as defined in our data sets was 18\,970 on January 1, 1900, 32\,900 on January 1, 1950 and 103\,970 when the century ended.



\section{Data and variables}

The recent extension in time of data at the Demographic Data Base (DDB), Umeå University (www.cedar.umu.se) by including the period between 1900 and 1950s makes it possible to investigate the long-term development of social inequality in mortality, in the present case from 1851 to 2013. The databases provide us with micro-data on a sufficiently large population and with substantial social diversity for the Skellefteå and Umeå regions \citep{wee16}. The data for the present study comes from two large population databases at the DDB. The early period until 1950 is covered by
the database Poplink, the digitisation of historical parish registers for
the Skellefteå and Umeå region \citep{wee16}. Poplink is based on linked parish records, allowing
us to reconstruct life biographies on people as long as they remained in
the region. The records are linked within but not between the regions. Data
from Poplink are accessed for the period 1851--1950.

The other large data-set is extracted from the Linnaeus database
\citep{malm10}. Linnaeus is based on different linked national population registers from
1960 to 2013 and is used within the ageing program at CEDAR, Umeå
University. The study period from 1960 to 2000 are constructed from censuses every fifth
year 1960--1990, with additional information on deaths from National Board of Health and Welfare. For the period 2002--2013 we use the information from the yearly population registers from Statistics Sweden (LISA) together with death information from National Board of Health and Welfare. 

Information on individuals are anonymised and the two databases are not
linked. This stops us from following individuals present
in both databases throughout their lives, thus they are treated separately. This
also makes it impossible to add information on individuals in the Linnaeus
database from what we potentially could find in Poplink, for example family
background or occupations earlier in life.

In the data-set analysed here, all individuals 40 years and older ever being resident in either
of the regions are included. The data file contains the variables on social class ({\sc Hisclass}) sex, urban/rural residence, birth date, death date, first and last date of observation and type of
entrance/exit. Total number of persons are 84\,599 leading to 35\,001 deaths in Poplink and 197\,864 persons leading to 66\,297 deaths in the Linnaeus database. See Figure~\ref{fig:lexis2}.

<<lexis2,fig.cap="The sampling frame.", fig.height = 5>>=
plot(c(1851, 1851, 1951, 1951, 1851), c(40, 90, 90, 40, 40),
     type = "l", xlim = c(1851, 2014), lwd = 2, col = "red",
     xlab = "Year", ylab = "Age", axes = FALSE, ylim = c(0, 90))
axis(1, at = c(1851, 1901, 1951, 1961, 1981, 2014), las = 2)
axis(2, las = 2, at = c(0, 40, 65, 90))
axis(4, las = 2, at = c(0, 40, 65, 90))
box()
abline(h = 0)
lines(c(1961, 1961, 2014, 2014, 1961), c(40, 90, 90, 40, 40),
      col = "blue", lwd = 2)
#
n.rec <- NROW(vb0[vb0$dataset == "poplink", ] )
n.pl <- with(vb0[vb0$dataset == "poplink", ], length(unique(id)))
n.d <-  with(vb0[vb0$dataset == "poplink", ], sum(event))
text(1900, 70, "PopLink", cex = 2, col = "red")
text(1899, 60, paste(n.rec, "records"))
text(1900, 55, paste(n.pl, "persons"))
text(1899.5, 50, paste(n.d, "deaths"))
#
n.rec <- NROW(vb0[vb0$dataset != "poplink", ] )
n.pl <- with(vb0[vb0$dataset != "poplink", ], length(unique(id)))
n.d <-  with(vb0[vb0$dataset != "poplink", ], sum(event))


text(1985, 70, "Linnaeus", cex = 2, col = "blue")
text(1984, 60, paste(n.rec, "records"))
text(1985.2, 55, paste(n.pl, "persons"))
text(1985.2, 50, paste(n.d, "deaths"))
@

\subsection{Presence periods}

Differences in available information in the two datasets as well as within the Linnaeus data makes it necessary to apply different approaches when it comes to identification of presence periods within our
regions. The Poplink data provides us with exact dates or at least year of
start and exit of the presence of all individuals in our data, allowing us to have full and continuous control of the de jure population. This is however not the case with the Linnaeus database. For the period 1960--2000 we use presence in the censuses 1960--1990 together with the yearly population registers 1986--2000 and information on deaths from the National Board of Health and Welfare to identify the observation periods in our analyses. There is however no full information on what happened in-between the censuses, for example the exact date of exit for persons that moved between two censuses. We have solved this by considering everyone as resident in our regions during the complete five-year period between censuses if the person is missing in the later census. This overestimates their presence in our regions, but should not bias the results when it comes to socioeconomic differences. We furthermore miss those that both moved in and moved out or vice versa between censuses. Exit dates are exact if they refer to death, and in these cases we consider them as constantly present from the last census to the death data even if the death took place in another part of Sweden.

For the last period, 2002--2013, we use the yearly population registers (LISA data), together with information on deaths from National Board of Health and Welfare. This data allows good control of the presence periods in the studied regions.



\subsection{Social class}

In this paper we analyse mortality differences according to social class based on the classification scheme {\sc Hisclass} \citep{lema11}. The only type of socio-economic information available both in Linnaeus and Poplink is occupations. Thus, analysing according to social class is apart from being a scientific choice, also a practical one. Using occupational data is the only and obvious alternative for making a longitudinal study of socio-economic mortality differences with consistent classification schemes. Social position is treated as a time-dependent variable.

The availability to information on occupations varies over time and between sources. Occupations in Poplink are coded into HISCO \citep{lema02} and the original DDB coding system. The censuses 1960--1990 include occupational codes based on the system used in Sweden at that time, NYK (Nordisk Yrkesklassificering). The yearly population registers (LISA) do not report occupations until 2001, thus there is a window of 11 years from 1991 to 2001 where we lack information. In the censuses, we have solved this by extending the periods for which we consider the observed social class to be valid. Thus, the social class in the census 1990 is considered to be kept until 2001. This strategy is also used for other cases of missing social class. Furthermore, we consider the last social position before retirement to be kept until death or last observation for those above 65. For the Linnaeus data, we use a script recoding HISCO into {\sc Hisclass}, provided to us by Jonas Helgertz, Lund University. 


The use of different data sets, forces us to apply different approaches towards defining the social position in some respects. A problem is that Poplink usually only provides the occupation for the head of household, thus under-estimating female working-force participation as well as that of adult children residing with their parents \citep{vik10}. In this study and according to the research questions in the present paper, we have chosen to categorise wife according to the position of the head of household, usually the husband/father, assuming that the family shares the same socio-economic position. This strategy makes the problem of under-recording less problematic.

Female labour is much better covered in the Linnaeus database. A complication is however that it is  difficult to define households in the same way as in Poplink. Extra-marital cohabitation, connected to the Second Demographic Transition \citep{van87, van03}, became common and female labour force participation developed as the norm in Sweden during this period. The occupation of the husband as signifier of social class became, if not obsolete, at least less relevant. All included persons are signified by their individual occupation for this period. Still, the results for the different periods are not completely comparable and makes the interpretation of the development for women more shaky.

{\sc Hisclass}, the classification system used here, is a "\ldots HISCO-based
historical international social class scheme" \citep{lema11, lema02}. The different classes in {\sc Hisclass} represent distinct categories, based on whether the work is manual or non–manual, skill level, supervision and sector. Implicitly it reflects large differences in what is in the forefront of other
categorisations, as for example access to economic and other resources, status, social power et cetera. We have merged the original 12 classes in {\sc Hisclass}, based on position in the labour market, ending up with the following three and an additional fourth category with unknown class:

\begin{enumerate}
\item {\tt elite}, {\sc Hisclass} 1 and 2. Higher managers, professionals and higher white collar.
\item {\tt middle}, {\sc Hisclass} 3, 4, 5, 6 and 8. Lower managers, farmers and lower white collar.
\item {\tt worker}, {\sc Hisclass} 7, 9, 10, 11 and 12. Workers including farm workers.
%%\item Lower skilled farm workers, HISCLASS 10 and 12, Lower and unskilled farm workers
\end{enumerate}





% The procedure for
% occupations in the Linnaeus database is a little more complicated. The
% occupations in the censuses (NYK) are first transferred to the system
% later in use, SSYK (the Swedish version of ISCO88). Thereafter the
% SSYK, both those transferred from the censuses and those given in the
% population registers 2001-2013, can be re-coded into HISCLASS.

Figures~\ref{fig:hiscskumm} and \ref{fig:hiscskumw} show the distribution (per cent) of exposure
time according to class for men and women respectively. The category of workers is
fairly stable over time. The highest class has increased substantially, although from a very low level in the 19th century. The increase of academics in connection to the establishment of
Umeå University explains much of this increase. What is hidden in Figure~\ref{fig:hiscskumm} is the transfer within the middle group from a majority of farmers during the 19th century to lower white collar from the middle of the 20th century. Furthermore we observe an increase during the 1960s and partly during later decades as well in those with undefined. When first observed in the earliest included censuses, occupation is often missing. For men the proportion is somewhat higher in the age group 65 and above, i.e. those that were retired, but still low enough to be used in our analyses. Until 1950, there were however very few with missing occupation. For men in working-active age, the proportion missing does not cause any problems for our analyses.   

<<hiscskumm, fig.cap = "Exposure by hisclass, men (from the top: elite, middle, workers, missing) and time period.", fig.height = 4.5>>=
xx <- with(vb0Tab[vb0Tab$sex == "male", ], tapply(exposure, list(period = period, hisclass = hisclass), sum))
yy <- round(prop.table(xx, 1) * 100, 1)
barplot(t(yy)[4:1, ], col = c("red", "blue", "green", "black"), las = 2, ylab = "Per cent")
@

<<hiscskumw, fig.cap = "Exposure by hisclass, women (from the top: elite, middle, workers, missing) and time period.", fig.height = 4.5>>=
xx <- with(vb0Tab[vb0Tab$sex == "female", ], tapply(exposure, list(period = period, hisclass = hisclass), sum))
yy <- round(prop.table(xx, 1) * 100, 1)
barplot(t(yy)[4:1, ], col = c("red", "blue", "green", "black"), las = 2, ylab = "Per cent")
@



% <<hiscskummyoung, fig.cap = "Exposure by hisclass, men 40-65 (from the top: elite, middle, workers, missing) and time period.", fig.height = 4.5>>=
% xx <- with(vb0Tab[vb0Tab$sex == "male" & vb0Tab$age %in% c("40", "45", "50", "55", "60"), ], tapply(exposure, list(period = period, hisclass = hisclass), sum))
% yy <- round(prop.table(xx, 1) * 100, 1)
% barplot(t(yy)[4:1, ], col = c("red", "blue", "green", "black"), las = 2, ylab = "Per cent")
% @
% 
% <<hiscskumwyoung, fig.cap = "Exposure by hisclass, women 40-65 (from the top: elite, middle, workers, missing) and time period.", fig.height = 4.5>>=
% xx <- with(vb0Tab[vb0Tab$sex == "female" & vb0Tab$age %in% c("40", "45", "50", "55", "60"), ], tapply(exposure, list(period = period, hisclass = hisclass), sum))
% yy <- round(prop.table(xx, 1) * 100, 1)
% barplot(t(yy)[4:1, ], col = c("red", "blue", "green", "black"), las = 2, ylab = "Per cent")
% @

The proportion with missing values among women is however a larger problem, see Figure~\ref{fig:hiscskumw}. Corresponding to what we found for men, the proportion without social position is very low until the middle of the 20th century. This is a reflection of how womens social position is defined for that period. Missing social class is however a real problem during the 1960s and 1970s in particular. Around 80 \% lack information for the 1960s and 50 \% for the 1970s. Since social class for this period is defined according to own occupation, the consequence of many women being outside the workforce, the proportion missing becomes very high. We have chosen not to report results for women for these two decades. For the later decades, the results are fairly complete and should be representative.

% The corresponding numbers for the age group 40--65 are shown in Figures~\ref{fig:hiscskummyoung} and 
% \ref{fig:hiscskumwyoung}. Slightly lower rates of missing occupation in comparison to Figures~\ref{fig:hiscskumm} and \ref{fig:hiscskumw} are noted. 

% <<nanam, results = 'asis'>>=
% library(xtable)
% ##load("data/vb0.rda")
% ##vb0$hisclass <- factor(vb0$hisclass, labels = c("elite", "lowMan", "lowWhiteC", "worker"))
% x <- with(vb0[vb0$sex == "male", ], table(period, hisclass, useNA = "ifany"))
% x <- round(prop.table(x, 1) * 100)
% xtable(x, caption = "Hisclass by time period, men. Per cent.", label = "tab:nana", digits = 0)
% @
% 
% <<nanaw, results = 'asis'>>=
% ##library(xtable)
% ##load("data/vb0.rda")
% ##vb0$hisclass <- factor(vb0$hisclass, labels = c("elite", "lowMan", "lowWhiteC", "worker"))
% x <- with(vb0[vb0$sex == "female", ], table(period, hisclass, useNA = "ifany"))
% x <- round(prop.table(x, 1) * 100)
% xtable(x, caption = "Hisclass by time period, per cent.", label = "tab:nana", digits = 0)
% @


\subsection{Marital status}

Marital status is treated as a time-dependent variable in the data file. The statuses used are unmarried, married and dissolved marriages (without distinguishing between widowed and divorces). If no explicit status is given in the sources and partner is missing, the status has been set to unmarried.

Regarding the distribution of marital status over time, see Figure~\ref{fig:civstskum}. The figure indicates an under-registration of those married and and over-registration of previously married during the 1960s.

<<civstskum, fig.cap = "Exposure by civil status (from the top: previously married, married and never married) and time period", fig.height = 4.5>>=
xx <- with(vb0Tab, tapply(exposure, list(period = period, civst = civst), sum))
yy <- round(prop.table(xx, 1) * 100, 1)
barplot(t(yy)[3:1, ], col = c("red", "blue", "black"), las = 2, ylab = "Per cent")
@

\subsection{Cause of death}
In the present study, we analyse mortality in the two most common disease
groups in the ages we are investigating---cardiovascular diseases and
cancers. National compulsory reporting of cause of death was introduced in 1911, thus our analysis of the two disease groups starts from that year. Classification systems have however changed. Sweden did not join ICD until 1952, but the historical causes of death in the Poplink database have been coded according to the ICD10 system. In the present study, we have identified the codes relevant for cardiovascular diseases and cancers in the ICD 8, 9 and 10.

The distribution of causes of death is shown in Figure~\ref{fig:causeskum}. Notice the high proportion of other causes in the first two periods. This category include cases with unknown or unspecific causes which has implications for the cause-specific analyses (see later discussion). The total dominance of our two disease groups is apparent.

<<causeskum, fig.cap = "Causes of death by time period (top: cancer, middle: cardiovascular, bottom: other).", fig.height = 4.5>>=
vb01 <- vb0[vb0$event == 1, ]
cancer <- tapply(vb01$cancer, vb01$period, sum)
heart <- tapply(vb01$heart, vb01$period, sum)
death <- tapply(vb01$period, vb01$period, length)
other <- death - cancer - heart
ttt <- rbind(cancer, heart, other)
ttt <- prop.table(ttt, 2) * 100
barplot(ttt[3:1, -(1:2)], col = 3:1, las = 2, ylab = "Per cent")
@

\subsection{Urban vs rural residence}
In 19th and early 20th century Sweden (as in other countries), mortality was much higher in urban environments. The unsanitary and overcrowded living conditions as well as the risks for importing infections made the health risks higher in towns and cities. In the present paper, we control for this aspect by distinguishing between urban and rural residence, based on in which parish people lived.

\subsection{Periods for analysis}
We have made separate analyses for the different periods. The century 1851--1950 is divided into four periods of 25 years each. The 19th century periods represent a mainly pre-industrial society dominated by agriculture and with restricted welfare provisions. During the years 1901--1950, industrialisation started and the urban environments increased in population size. The modern welfare state began to develop during this time. For the period 1960 on-wards, there are separate analyses on decades except for the two last periods. Sweden had developed into a wealthy welfare society with low income inequality in international comparison, particularly until the 1990s. A financial crisis struck Sweden in the early 1990s, which among other things increased unemployment and changed parts of the welfare system to being less generous than before. The start of the last period (2008--2013) coincides with the international financial crisis.

\subsection{Income}
Income is based on disposable individual income from the LISA database at Statistics Sweden, grouped into quartiles. It is only analysed from 1986 to 2005.

\subsection{Education}
Education is here analysed only for the period 1990 to 2013. Years of education are given in 3 categories and is based on level of education according to categories in the LISA database at Statistics Sweden. It ranges from basic education (nine years of schooling or less) at the lowest level, secondary education (high school or similar) for the middle group and to academic degree at the highest level.

\section{Models}

The proportional hazards model in a survival analysis context is used,
allowing for adjustment for civil status and rural/urban environment. Since
the central explanatory variable, {\sc Hisclass}, do not follow the
proportionality property, the analyses are stratified with respect to the
variable, and the main results are presented graphically.

Another practical problem is the size of that data set:
It contains no less than 2\,432\,871 records of 236\,011 individuals, of
which 68\,244 are observed to die.
This makes it very inconvenient to use the nowadays so popular semi-parametric
technique known as
\emph{Cox regression} \citep{cox72,gb02}. Instead we use a parametric model
that allows for reduction of the data
to \emph{sufficient statistics} \citep{fisher22}. The idea is to keep all
relevant covariates \emph{categorical}, and then create a table with all
possible combinations of levels of the covariates. For each such
combination, the total amount of exposure and the number of deaths are
calculated.  We have two sexes, three civil statuses, ten periods, two
urban/rural groups, four hisclasses at age 40,  four hisclasses at age 60,
ten age groups, and 22 cohorts, in all 422\,400 possible
combinations. However, in this scheme there are many structural zeroes
(impossible combinations) and some random zeros, so the actual number of
combinations we end up with is 24\,326. The data set is thus reduced in
size by 99 per cent.

The parametric model we use for the baseline hazard function is piece-wise
constant on five-year intervals, so we arrive at the following proportional
hazards regression model:

\begin{equation}\label{eq:prop}
h(t; \lambda, \boldsymbol{\beta}, \textbf{x}) =
\lambda(t)e^{\boldsymbol{\beta} \mathbf{x}}, \; \; 40 < t \le 90,
\end{equation}
where

\begin{equation*}
\begin{split}
\mathbf{x} &= (x_1, \ldots, x_n) \text{\ is a vector of covariates,} \\
\boldsymbol{\beta} &= (\beta_1, \ldots, \beta_n) \text{\ is the corresponding vector of regression
parameters.} \\
\end{split}
\end{equation*}
and
\begin{equation*}
\lambda(t) = \alpha_i,\; 40 + 5(i - 1) < t \le 40 + 5i, \; i = 1, \ldots, 10.
\end{equation*}

Since all components of $\mathbf{x}$ are categorical covariates, the
estimation of \eqref{eq:prop} can be performed in two ways, first by the
original data set and a survival analysis routine handling a piecewise
constant hazard, or second, by the reduced data set (table) and
\emph{Poisson regression}. The second way is faster than the first by a
factor of size at least 100, often much more, depending on hardware, and
the point is that the two ways give exactly the same results. This is
because the table is a \emph{sufficient statistic} for \eqref{eq:prop} and
the original data set.


The analyses are performed in the \R\ environment for statistical computing
and graphics \citep{cran}, especially using the package {\tt eha} 
\citep{gb12,eha}
The proportional hazards model allow us to scrutinise the differences and
the development in more detail. We divide the analysis into two age groups,
40--64 and 65--89 years of age, the first age group representing people that
were still mainly in the workforce, and the second those that mainly were 
retired. The model controls for marital
status and whether the individual resides in the urban or rural parts of the regions. There
are no serious signs of deviation from proportionality assumption, except
regarding {\sc Hisclass}. Each period are analysed separately, but we then combine results
in order to show the development of the social patterning of mortality
during the studied period.

% We analyse both regions together but perform separate analyses for men and
% women and for the age groups 40--64 and 65--89. The model in the analyses
% include social class, sex and marital status. 
 

% We present the results for the period 2001--2013
% separately. We suggest a heterogeneity index in order to investigate a
% possible homogenisation of mortality between social classes.

The important explanatory variable, {\tt hisclass}, is included in the
proportional hazards models as a \emph{stratification} variable. The main
reason for this choice is that the effect of {\tt hisclass} on survival is
non-proportional, that is, it varies with age. With the reduced data set
and Poisson regression, this is simply achieved by introducing an
interaction term between {\tt age} and {\tt hisclass}. Then, the main
results are presented \emph{graphically}. Tables with results from the different models are presented at the end of the article, but are not commented on in detail. The comments on the results are primarily based on the figures and focuses on the central variable in our study---{\tt hisclass}. As can be seen from the tables, most variables in the model are significant at 5 per cent level.

% There is some  lack of information in the higher
% ages around 1960--1980 (see Figures~\ref{fig:hiscskumm} and \ref{fig:hiscskumw}), because that kind of 
% information is simply missing to a large extent.



\section{The effect of {\sc Hisclass}, 1851--1950, 1961--2013}

\subsection{All causes of death}

<<colorc>>=
## Colors for plotting strata:
scol <- c("blue", rep("darkgreen", 2), "red")
## Common for all groups:

labb <- levels(vb0Tab$period)
nper <- length(labb)
#source("R/getPHglm.R")
## End 'common'
@

The cumulative
hazards at the end of the time period (65 if 40--64, 90 if 65--89) are the
main target in our analysis: These numbers are used in the process of
graphically illustrating the development over time.

%creating an \emph{heterogeneity index} (a better name is needed:
%\emph{health disparity index}, \emph{Social Inequality Mortality Index, (SIMI)}?
%Something catchy.).

\subsubsection{Ages 40--64}

%The distribution over time periods.
<<getske4060>>=
cap1w <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, women."
scap1w <-  "Cumulative hazards, ages 40--64, women."
cap1m <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, men."
scap1m <-  "Cumulative hazards, ages 40--64, men."
##
cap0 <- "Total hazard of dying before age 65 for a 40 year old person by HISCLASS and decade, women (top) and men (bottom)."
scap0 <- "Total hazard by HISCLASS, ages 40--64."
cap12 <- "Total hazard of dying before age 65 for a 40 year old person standardised by HISCLASS and decade, women (top) and men (bottom)."
scap12 <- "Total hazard standardised by HISCLASS, ages 40--64."
cap12log <- "Total hazard of dying before age 65 for a 40 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades."
scap12log <- "Total hazard by HISCLASS, ages 40--64, last years."

cap2w <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, women."
scap2w <-  "Cumulative hazards, ages 65--89, women."
cap2m <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, men."
scap2m <-  "Cumulative hazards, ages 65--89, men."
##
cap22 <- "Total hazard of dying before age 90 for a 65 year old person by HISCLASS and decade, women (top) and men (bottom). Standardised."
scap22 <- "Total hazard by HISCLASS, ages 65--89."
cap22log <- "Total hazard of dying before age 90 for a 65 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades."
scap22log <- "Total hazard by HISCLASS, ages 65--89, last years."

##
vb4064 <- vb0Tab[as.numeric(as.character(vb0Tab$age)) < 64.5, ]
vb4064$age <- factor(vb4064$age)
##vb4064$hisclass <- vb4064$hisclass40
@

% We start by looking at cumulative hazards by {\sc Hisclass} over the last four time
% periods, in order to illustrate the process. They are adjusted for {\tt civil status}. We present separate analyses  for women and men, see
% Figures~\ref{fig:hazplotw} and~\ref{fig:hazplotm}.

%\subsubsection{Women}

<<hazcalw>>=
source("R/getPHglm2.R")
##nper <- 4
nper <- length(labb)
resw <- getPHglm2(vb4064[vb4064$sex == "female", ],
            nper, labb)
resm <- getPHglm2(vb4064[vb4064$sex == "male", ],
            nper, labb)
@

% 
% 
% <<hazplotw, fig.cap = cap1w, fig.scap = scap1w, fig.height = 7>>=
% source("R/plotHaz.glm.R")
% 
% plotHaz.glm(resw[-(1:6)], main = labb, col = scol, layout = c(2, 2))
% @
% 
% <<hazplotm, fig.cap = cap1m, fig.scap = scap1m, fig.height = 7>>=
% plotHaz.glm(resm[-(1:6)], main = labb, col = scol, layout = c(2, 2))
% @
% 
% From Figures~\ref{fig:hazplotw} and \ref{fig:hazplotm} it is obvious that
% the idea of proportional hazards is not reasonable. We therefore use another approach.

%The "TMR", that is, the summed hazards over the age interval 40--64 is shown in
%Figure~\ref{fig:cumsw}.

<<cumsw, fig.cap = cap0, fig.scap = scap0, fig.height = 8>>=
source("R/plotED.glm.R")
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, ylab = "TMR(65|40)",
                main = "Women 40-64", exclude = 5:6)
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, ylab = "TMR(65|40)",
                main = "Men 40-64")##, exclude = 5:6)
par(oldpar)
@

From Table~\ref{tab:cumswtab} it is obvious that the statistical significance is strong.
The most interesting feature is the three-way interaction with {\tt sex}, {\tt period}, and {\tt hisclass}.

<<cumswtab,results='asis',cap="Table">>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex * hisclass * period, 
            data = vb4064, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:cumswtab", caption = "Anova, all causes of death, 40-65.")
@

Figure~\ref{fig:cumsw} shows the summed hazards of dying in the age interval 
40--64 during the different periods. Obviously, and not surprisingly, mortality 
is decreasing over time for both sexes. Women have consistently better survival 
than men. This is a well-known phenomenon in Swedish
demographic history. Male mortality has almost always been higher than
female in all age groups \citep{wil99, suwi07}. We also observe a
substantial decline in mortality for both sexes, resulting in smaller
absolute differences between social classes. The compression that is
visible for later decades is partly explained by the decreasing general
mortality and is not necessarily representing a homogenisation of relative risks.


By \emph{standardising} the levels in each time period for each class, we illustrate the relative risks in Figure~\ref{fig:cumswstand}. In the rest of the paper, we only present these 
relative mortality levels for the different classes.

<<cumswstand, fig.cap = cap12, fig.scap = scap12, fig.height = 8>>=
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(65|40)", main = "Women 40-64", exclude = 5:6)
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(65|40)", main = "Men 40-64")##, exclude = 5:6)
par(oldpar)
@

%%<<cumsm, fig.cap = "Total haz of deaths in ages 40--64 per individual by HISCLASS and decade, men.">>=
%%@


%% HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH

Notice that we have not analysed the 1950s due to the fact that we only have data for some parishes at that time, consequently having no corresponding population for that decade. Furthermore, we have excluded the results for women during the 1960s and 1970 of reasons discussed above. The changing economy also have consequences for the analysis, particularly when it comes to the agricultural sector. While farmers were common occupations during the first half of the 20th century, these occupations has constantly decreased in numbers thereafter. This means that the middle class has somewhat different character during the last periods.

The most striking result of the analysis is the different patterns for men and women. The social pattern of mortality among women is quite much in accordance with previous
analyses from the present research group on other regions in northern
Sweden and for other periods \citep{edli11,edbr12}. The highest
social class usually have comparatively low mortality, while working
class women have high. There is however no substantial change in the relative risks between the classes. Only the group with unknown social class is distinguished by moch higher mortality from the 1980s onwards. This can however have to do with the differences how social position for women is defined before and after 1950. After 1950 it is based on the own occupation. Being without occupation might include women that are more frail both when it comes to health and socially. 

A different pattern appears among men, being the most surprising finding in our analyses. The groups we would expect to have the lowest mortality, if we assume that access to different resources and
having a high status determines survival, instead have by far the highest hazards of dying during the nineteenth and much of the 20th century. This is also in accordance with our previous studies
\citep{edli11, edbr12}. Workers on the other hand have comparatively low mortality until the 1960s, at the same level as the middle class. The relative positions change radically towards the end the 20th century. From the 1980s, there is a clear advantage when it comes to survival for higher
managers and professionals. The relative differences are however more compressed than for the period until 1950. The expected social gradient in mortality has developed. This is also what we usually find in analyses of social health inequalities in present-day Sweden as well as in most
other countries. In the regions we are studying, this is however a quite
recent phenomenon. Corresponding to what we find for women, those without known occupation have much higher mortality than the others from the 1960s onwards. The assumption made for women of unknowns social class is probably even more relevant for men. They probably represent groups in society that are particularly vulnerable.

A further observation can be made from Figure~\ref{fig:cumsw}. The gender difference in death hazards is very big for the élite group from 1851--1950, men having about three times higher risks than women in the same class. In the other classes, the difference was much smaller. It was men in high position that experienced the largest risks.

% \subsubsection{The effect of income and education, 1986--2013}
% 
% A common alternative to a class analysis is to use income or education for investigating socio-economic health differences. 
% Comparing different approaches are furthermore valuable in order to understand why some are advantaged and others 
% disadvantaged. For the time being, we have to restrict such a comparative analysis to the last decades.
% 
% The analysis for the period 1990--2005 is based on a separate analysis with 
% income and education as explanatory variables and with controls of period 
% and marital status.
% 
% <<lissyoung>>=
% library(eha)
% library(xtable)
% liss4064 <- loTab[loTab$age < 64.5, ]
% con <- url("http://capa.ddb.umu.se/data/lisaold.rda")
% ##load("data/lisaold.rda")
% load(con)
% close(con)
% @
% 
% Both education and income had a strong, statistically significant, effect on survival, as expected. 
% 
% \paragraph{Education, 1990--2013}
% 
% <<educ>>=
% 
% educ <- lisaold[!(lisaold$period %in% c("1986-1987", "1988-1989")), ]
% educ$period <- factor(educ$period)
% educ <- educ[!is.na(educ$educ), ]
% levels(educ$educ) <- c("low", "low", "middle", "middle", "middle", "high", "high")
% ##educ$educ <- relevel(educ$educ, ref = "middle")
% educ$civst <- relevel(educ$civst, ref = "married")
% fitm <- coxph(Surv(enter, exit, event) ~ strata(educ) + civst + urban,
%              data = educ[educ$sex == "male", ])
% fitf <- coxph(Surv(enter, exit, event) ~ strata(educ) + civst + urban,
%              data = educ[educ$sex == "female", ])
% cols <- c("red", "darkgreen", "black")
% @
% 
% <<ploteduc, fig.cap="Survival by education and sex, 1990--2013.">>=
% oldpar <- par(mfrow = c(1, 2))
% 
% plot(survfit(fitm, start.time = 40), mark.time = FALSE, main = "Men",
%      col = cols, lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
% axis(1)
% axis(2, at = c(0, 0.5, 1.0), las = 1)
% abline(h = 0.5, lty = 3)
% box()
% legend("bottomleft", legend = levels(educ$educ), col = cols, lty = 1, lwd = 1.5)
% 
% plot(survfit(fitf, start.time = 40), mark.time = FALSE, main = "Women",
%      col = cols, lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
% axis(1)
% axis(2, at = c(0, 0.5, 1.0), las = 1)
% abline(h = 0.5, lty = 3)
% box()
% legend("bottomleft", legend = levels(educ$educ), col = cols, lty = 1, lwd = 1.5)
% 
% par(oldpar)
% @
% 
% Those with the two lowest education level hade the highest mortality, while those with highest level of education had by far the best survival. The differences must be considered large, and it follows almost a continuous improvement according to increasing levels. 
% 
% \paragraph{Income, 1986--2005}
% 
% <<femeduc>>=
% income <- lisaold[!is.na(lisaold$income), ]
% income$period <- factor(income$period)
% ##income <- income[!is.na(income$income), ]
% ##levels(income$income) <- c("low", "low", "middle", "middle", "middle", "high", "high")
% ##income$income <- relevel(income$income, ref = "low")
% income$civst <- relevel(income$civst, ref = "married")
% fitm <- coxph(Surv(enter, exit, event) ~ strata(income) + civst + urban,
%              data = income[income$sex == "male", ])
% fitf <- coxph(Surv(enter, exit, event) ~ strata(income) + civst + urban,
%              data = income[income$sex == "female", ])
% cols <- c("darkgreen", "red", "blue", "black")
% 
% @
% 
% <<plotincome, fig.cap="Survival by income and sex, 1986--2005.">>=
% oldpar <- par(mfrow = c(1, 2))
% 
% plot(survfit(fitm, start.time = 40), mark.time = FALSE, main = "Men",
%      col = cols, lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
% axis(1)
% axis(2, at = c(0, 0.5, 1.0), las = 1)
% abline(h = 0.5, lty = 3)
% box()
% legend("bottomleft", legend = levels(income$income), col = cols, lty = 1, lwd = 1.5)
% 
% plot(survfit(fitf, start.time = 40), mark.time = FALSE, main = "Women",
%      col = cols, lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
% axis(1)
% axis(2, at = c(0, 0.5, 1.0), las = 1)
% abline(h = 0.5, lty = 3)
% box()
% legend("bottomleft", legend = levels(income$income), col = cols, lty = 1, lwd = 1.5)
% 
% par(oldpar)
% @
% 
% Higher incomes result in lower mortality. This is also what could be expected, 
% and conforms to what we know of social health differences in present-day Sweden. 
% Notice however that we cannot establish a causal relationship between 
% income and mortality. Bad health, for instance, may be a confounder.
% 
% %%The statistical significance of the covariates are shown in Table~\ref{tab:liswom}.
% %%<<liswom, results = 'asis'>>=
% %%fitw1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "female", ])
% %%##cat("Women:\n")
% %%drw <- drop1(fitw1, test = "Chisq")
% %%xtable(drw, caption = "Effect of covariates for women 40-64, 1990-2005.", label = "tab:liswom")
% %##round(summary(fitw1)$coef[-(1:13), ], 4)
% %@
% 
% %%The estimated effect sizes for women are shown in Figure \ref{fig:liswomfig}.
% 
% %%<<liswomfig, fig.cap = "Effect sizes, women 40-64, 1990-2005.", fig.height = 4>>=
% %%source("R/plotWEduc.R")
% %%plotWEduc(fitw1)
% %%@
% 
% 
% %%And for men:
% 
% %%<<lismen, results='asis'>>=
% %%fitm1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "male", ])
% %%##cat("\nMen:\n")
% %%drm <- drop1(fitm1, test = "Chisq")
% %%xtable(drm, caption = "Effect of covariates for men 40-64, 1990-2005.")
% %%##round(summary(fitm1)$coef[-(1:13), ], 4)
% %%dcol <- c("blue", "darkgreen", "darkgreen", "red")
% %%@
% 
% %%<<lismanfig, fig.cap = "Effect sizes, men 40-64, 1990-2005.", fig.height = 4>>=
% %%#source("R/plotWEduc.R")
% %%plotWEduc(fitm1)
% %%@
% 
% % 
% % <<plotliss1, fig.cap = "Cumulative hazards, ages 40--64, 2002--2013.", fig.height = 4>>=
% % #oldpar <- par(mfrow = c(1, 2))
% % #plot(fitw1, fn = "cum", col = dcol, main = "Women")
% % #plot(fitm1, fn = "cum", col = dcol, main = "Men")
% % #par(oldpar)
% % ##summary(fitw1)
% % ##summary(fitm1)
% % @
% % 
% % %See Table~\ref{tab:tablisswom1} the PH regression for women.
% % <<tablisswom1, results = "asis">>=
% % #fitwo1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% % #                 data = liss4064[liss4064$sex == "female", ])
% % #dr <- drop1(fitwo1, test = "Chisq")
% % #ltx(fitwo1, dr = dr, caption = "PH regression, women aged 40--64, 2002--2013.",
% % #    label = "tab:tablisswom1")
% % @
% % 
% % %See Table~\ref{tab:tablissman1} the PH regression for men.
% % <<tablissman1, results = "asis">>=
% % #fitma1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% % #                 data = liss4064[liss4064$sex == "male", ])
% % #dr <- drop1(fitma1, test = "Chisq")
% % #ltx(fitma1, dr = dr, caption = "PH regression, men aged 40--64, 2002--2013.",
% %  #   label = "tab:tablissman1")
% % @
% 





\subsubsection{Ages 65--89}

%The distribution over time periods.
<<getske6089>>=
vb6589 <- vb0Tab[as.numeric(as.character(vb0Tab$age)) >= 64.5, ]
vb6589$age <- factor(vb6589$age) # NOTE:: Change to '6589'!
##vb6589$hisclass <- vb6589$hisclass60
@

We now turn to the elderly, i.e. those that in most cases have left the workforce.
Corresponding to the previous analysis, we use the value of the cumulative hazards at
duration 25 (age 90), starting from age 65 as a summary measure.

The general pattern and development of mortality (not shown here) do not differ that much from the younger age group, of course representing a much higher mortality level earlier in history. Mortality among women was, as expected, lower than among men. We find a clear decline in mortality, but the fastest decline did not set in definitely until sometimes after the Second World War (results not shown here), i.e. later than for the age group 40--64 years. This corresponds to the Swedish development where we find a turning point at this time with better survival among elderly, to a large extent caused by lower mortality in cardiovascular diseases. 

Concerning the social pattern, the pattern is less clear compared to what we found for the younger age group (see Figure~\ref{fig:cumswold}). For women the results are mixed. Once again, too much missing data on social class leaves out the results for the 1960s and 1970s. We do not find the same clear advantage for élite women during period until 1950, but neither do we find any large disadvantage for working class elderly women at that time. In some periods, the social differences were small, and the élite even had substantially higher mortality during the early 20th century. The social differences continued to be small during the last decades of the 20th century. Only during the two last periods (after the year 2000) is it possible to establish the expected social gradient in mortality.

For men we find indications of the same intriguing change among elderly as for
the adult male population 40--64 years. Mortality was in fact substantially
higher among élite men  but their disadvantage was primarily apparent during the 19th century. Differences are fairly small during the first half of the 20th century. Not until the second half of the 20th century is the survival much better for the highest social class while workers in the age of retirement had high mortality in comparison. ). This is quite unexpected, since other studies have shown clear socio-economic differences in Sweden during recent decades. 


<<cumswold, fig.cap = cap22, fig.scap = scap22, fig.height = 8>>=
##source("R/plotED.R")
resw <- getPHglm2(vb6589[vb6589$sex == "female", ],
            nper, labb)
resm <- getPHglm2(vb6589[vb6589$sex == "male", ],
            nper, labb)

oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(90|65)", main = "Women 65-89", exclude = 5:6)
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(90|65)", main = "Men 65-89")##, exclude = 5:6)
par(oldpar)
@

See Table~\ref{tab:cumswoldtab}.

<<cumswoldtab,results='asis'>>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex * hisclass * period, 
            data = vb6589, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:cumswoldtab", caption = "Anova, all causes of death, 65-89.")
@

% \subsubsection{The effect of income and education, 1990--2005}
% 
% The fact that we find rather unclear associations between HISCLASSES and survival, makes alternative approaches to the question of socio-economic health differences interesting. As for the younger age group, we have included an analysis for the period 1990--2005 with income and education as explanatory variables.
% 
% <<lissyoung2>>=
% library(eha)
% library(xtable)
% ##load("data/loTab.rda")
% ##loTab$period <- factor(loTab$period)
% liss6589 <- loTab[loTab$age > 64.5, ]
% @
% 
% 
% The statistical significance of the covariates are shown in
% Table~\ref{tab:liswom2}
% <<liswom2, results = 'asis'>>=
% fitw2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "female", ])
% ##cat("Women:\n")
% drw2 <- drop1(fitw2, test = "Chisq")
% xtable(drw2, caption = "Effect of covariates for women 65-89, 1990-2005.", label = "tab:liswom2")
% ##round(summary(fitw1)$coef[-(1:13), ], 4)
% @
% 
% The estimated effect sizes are shown in Figure \ref{fig:liswomfig2}
% 
% <<liswomfig2, fig.cap = "Effect sizes, women 65-89, 1990-2005.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitw2)
% @
% 
% 
% And for men:
% 
% <<lismen2, results='asis'>>=
% fitm2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "male", ])
% ##cat("\nMen:\n")
% drm2 <- drop1(fitm2, test = "Chisq")
% xtable(drm2, caption = "Effect of covariates for men 65-89, 1990-2005.")
% ##round(summary(fitm1)$coef[-(1:13), ], 4)
% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% @
% 
% <<lismanfig2, fig.cap = "Effect sizes, men 65-89, 1990-2005.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitm2)
% @
% 
% These figures show clear associations both with income and education and for women as well as for men. More years of education resulted in lower mortality. For women the association with additional levels became however smaller at the higher levels, the effect is more visible at the steps above the basic levels. In a similar fashion, increased incomes is associated with improved survival both for men and for women. Apparently, education and income is better to catch up socio-economic differences compared to hisclass, at least for this period.

\subsection{Cardiovascular mortality}

In this section, the focus is on analyses of mortality from the two dominant causes of death among the adult and elderly population. We start with cardiovascular diseases. Many studies have shown that socio-economic conditions are strongly associated with mortality in this disease group. Belonging to working class, having less education and low income increases the mortality risks. We would therefore expect to find a clear social pattern in the present analysis.

First, a general observation is that the analysis of causes of death and its development is difficult to interpret, partly because the number of cases are fewer but also that the quality and coverage of reported death causes differ. Thus, many deaths during the early 20th got quite unspecific causes reported in the death registers. There was still a substantial part of all deaths where cause was diagnosed as unknown or dying from old age, despite the fact that reporting causes of death had become mandatory. For the period 1901--1925 to 1926--1950, the proportion of deaths from cardiovascular diseases increased from 25 to 43 per cent for the age group 40 and above, thus indicating an increase of these diseases. However, at the same time unknown cause and death of old age decreased from 28 percent to 18 per cent. It is quite reasonable to suspect that many cardiovascular deaths were disguised in unspecific categories and that the increase partly is explained by improvements in how deaths were diagnosed.
<<causes41>>=
cvb <- vb0
cvb$event <- cvb$heart ## Can this be done better?
cvb <- cvb[!(cvb$period %in% c("1851-1875", "1876-1900")), ]
cvb$period <- factor(cvb$period)

# load("data/vb.rda")
# ##vb <- cal.window(vb, c(1961, 2001))
# ##x <- substr(vb$ULORSAK, 1, 2)
# vb$event <- vb$event & vb$heart
# vb$exposure <- with(vb, exit - enter)
# vb$cohort <- factor(vb$cohort)
# vb$period <- factor(vb$period)
cvbTab <- aggregate(cvb[, c("event", "exposure")],
                    cvb[, c("sex", "age", "period", "cohort",
                           "urban", "civst", "hisclass")],
                    FUN = sum)
 cvbTab$hisclass <- factor(cvbTab$hisclass)
 cvbTab$age <- factor(cvbTab$age)
@

<<41colorc>>=
## Colors for plotting strata:
scol <- c("blue", rep("darkgreen", 2), "red")
## Common for all groups:

labb <- levels(cvbTab$period)
nper <- length(labb)
##source("R/getPHglm.R")
## End 'common'
@

As before, models are fitted separately for sex and each ten-year time period, from  1901 to
2013. We stratify on {\tt hisclass} and include the covariates {\tt urban} (TRUE or FALSE) and 
{\tt civst} (marital status). The cumulative
hazards at the end of the age period (65 if 40--64, 90 if 65--89) are the
main target in our analysis: These numbers are used in the process of graphically illustrating the development over time.

%creating an \emph{heterogeneity index} (a better name is needed:
%\emph{health disparity index}, \emph{Social Inequality Mortality Index, (SIMI)}?
%Something catchy.).

\subsubsection{Ages 40--64}

%The distribution over time periods.
<<41getske4060>>=
cap1w <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, women, cardiovascular death."
scap1w <-  "Cumulative hazards, ages 40--64, women, cardiovascular death."
cap1m <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, men, cardiovascular death."
scap1m <-  "Cumulative hazards, ages 40--64, men, cardiovascular death."
##
cap12 <- "Total hazard of dying before age 65 for a 40 year old person standardised by HISCLASS and decade, women (top) and men (bottom), cardiovascular death."
scap12 <- "Total hazard by HISCLASS, ages 40--64, cardiovascular death."
cap12log <- "Total hazard of dying before age 65 for a 40 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades, cardiovascular death."
scap12log <- "Total hazard by HISCLASS, ages 40--64, last years, cardiovascular death."

cap2w <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, women, cardiovascular death."
scap2w <-  "Cumulative hazards, ages 65--89, women, cardiovascular death."
cap2m <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, men, cardiovascular death."
scap2m <-  "Cumulative hazards, ages 65--89, men, cardiovascular death."
##
cap22 <- "Total hazard of dying before age 90 for a 65 year old person standardised by HISCLASS and decade, women (top) and men (bottom), cardiovascular death."
scap22 <- "Total hazard standardised by HISCLASS, ages 65--89, cardiovascular death."
cap22log <- "Total hazard of dying before age 90 for a 65 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades, cardiovascular death."
scap22log <- "Total hazard by HISCLASS, ages 65--89, last years, cardiovascular death."

##
cvb4064 <- cvbTab[as.numeric(as.character(cvbTab$age)) < 64.5, ]
cvb4064$age <- factor(cvb4064$age)
@

Performing the same types of analyses as for all-cause mortality, we start by looking at cumulative hazards by {\sc Hisclass} at age 65, given survival to age 40. 

%\subsubsection{Women}

<<41hazcalw>>=
source("R/getPHglm2.R")
resw <- getPHglm2(cvb4064[cvb4064$sex == "female", ],
            nper, labb)
resm <- getPHglm2(cvb4064[cvb4064$sex == "male", ],
            nper, labb)
@


% We will use as a summary measure the value of the cumulative hazards at
% age 65, given survival to age 40.

<<41cumsw, fig.cap = cap12, fig.scap = scap12, fig.height = 8>>=
source("R/plotED.glm.R")
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE, exclude = 3:4,
                    ylab = "TMR(65|40)",  main = "Women 40-64")
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE, ##exclude = 1:2,
                    ylab = "TMR(65|40)", main = "Men 40-64")
par(oldpar)
@

%%<<cumsm, fig.cap = "Total haz of deaths in ages 40--64 per individual by HISCLASS and decade, men.">>=
%%@
<<41cumswtab,results='asis'>>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex * hisclass + 
                sex * period + hisclass * period, 
            data = cvb4064, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:41cumswtab", caption = "Anova, cardiovascular deaths, 40-64.")
@

See Table~\ref{tab:41cumswtab}.

Figure~\ref{fig:41cumsw} shows mortality levels during different periods from 1901 on-wards. Women from the highest social class had consistently lower mortality from cardiovascular diseases compared to the others. We also observe increasing social differences from the first half of the century to the last decades. A new pattern has developed from 1980 onwards. Now working class women have substantially higher cardiovascular mortality compared to others. We can however not exclude that this is an artefact of different diagnostics for deaths in different groups. Working class women may have had less precise diagnoses in the early 20th century.

For men, there is a different pattern, a pattern however that to a large extent is consistent with what we observed concerning all-cause mortality. The elite group had much higher cardiovascular diseases up until the middle of the 20th century, but instead have the lowest mortality from 1980 onwards. Working class men had a fairly low cardiovascular mortality, but in the same way as among women, the levels were fairly similar to the one of the middle category consisting of lower manager/farmers. And in the same way as for women at this age, working class men have the highest mortality from this cause of death during the last decades. A social hierarchy in cardiovascular mortality seems to have developed both for men and women.

% A word of caution is however needed when it comes to these results. We can not exclude that the smaller differences in cardiovascular diseases for women in the early periods are an artefact of how deaths were diagnosed. Working class men and women may have had less precise diagnoses in the early 20th century.

%% HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH

% \subsubsection{The effect of income and education, 1990--2005}
% 
% We have also performed the analysis on the alternative approaches on socio-economic differences for the causes of death. It is based on a separate analysis with income and education as explanatory variables.
% 
% <<41lissyoung>>=
% library(eha)
% library(xtable)
% ##load("data/loTab.rda")
% loTab$period <- factor(loTab$period)
% liss4064 <- loTab[loTab$age < 64.5, ]
% @
% 
% 
% The statistical significance of the covariates are shown in
% Table~\ref{tab:41liswom}
% <<41liswom, results = 'asis'>>=
% fitw1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "female", ])
% ##cat("Women:\n")
% drw <- drop1(fitw1, test = "Chisq")
% xtable(drw, caption = "Effect of covariates for women 40-64, 1990-2005, cardiovascular death.", label = "tab:41liswom")
% ##round(summary(fitw1)$coef[-(1:13), ], 4)
% @
% 
% The estimated effect sizes are shown in Figure \ref{fig:41liswomfig}
% 
% <<41liswomfig, fig.cap = "Effect sizes, women 40-64, 1990-2005, cardiovascular death.", fig.height = 4>>=
% source("R/plotWEduc.R")
% plotWEduc(fitw1)
% @
% 
% 
% And for men:
% 
% <<41lismen, results='asis'>>=
% fitm1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "male", ])
% ##cat("\nMen:\n")
% drm <- drop1(fitm1, test = "Chisq")
% xtable(drm, caption = "Effect of covariates for men 40-64, 1990-2005, cardiovascular death.", label = "tab:41lismen")
% ##round(summary(fitm1)$coef[-(1:13), ], 4)
% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% @
% 
% <<41lismanfig, fig.cap = "Effect sizes, men 40-64, 1990-2005, cardiovascular death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitm1)
% @
% 
% 
% <<41plotliss1, fig.cap = "Cumulative hazards, ages 40--64, 2002--2013, cardiovascular death.", fig.height = 4>>=
% #oldpar <- par(mfrow = c(1, 2))
% #plot(fitw1, fn = "cum", col = dcol, main = "Women")
% #plot(fitm1, fn = "cum", col = dcol, main = "Men")
% #par(oldpar)
% ##summary(fitw1)
% ##summary(fitm1)
% @
% 
% %See Table~\ref{tab:tablisswom1} the PH regression for women.
% <<41tablisswom1, results = "asis">>=
% #fitwo1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% #                 data = liss4064[liss4064$sex == "female", ])
% #dr <- drop1(fitwo1, test = "Chisq")
% #ltx(fitwo1, dr = dr, caption = "PH regression, women aged 40--64, 2002--2013.",
% #    label = "tab:tablisswom1")
% @
% 
% %See Table~\ref{tab:tablissman1} the PH regression for men.
% <<41tablissman1, results = "asis">>=
% #fitma1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% #                 data = liss4064[liss4064$sex == "male", ])
% #dr <- drop1(fitma1, test = "Chisq")
% #ltx(fitma1, dr = dr, caption = "PH regression, men aged 40--64, 2002--2013.",
%  #   label = "tab:tablissman1")
% @
% 
% The analysis of cardiovascular mortality according to education and income conforms very well to what we find for all-cause mortality, and we will therefore not delve into detail on this issue. More education as well as higher income is advantageous both for women and men for avoiding deaths related to the circulatory system. This is also well in line with our analysis based on HISCLASS above.

\subsubsection{Ages 65--89}

%The distribution over time periods.
<<41getske6089>>=
cvb6589 <- cvbTab[as.numeric(as.character(cvbTab$age)) >= 64.5, ]
cvb6589$age <- factor(cvb6589$age) # NOTE:: Now change to '6589'!
@

In this section we focus on cardiovascular mortality among those that mostly have left the workforce, the age group 65--89 years. We use as a summary measure the value of the cumulative hazards at
duration 25 (age 90), starting from age 65.

%\subsubsection{Women}

<<41hazcalwold>>=
resw <- getPHglm2(cvb6589[cvb6589$sex == "female", ],
              nper, labb)
resm <- getPHglm2(cvb6589[cvb6589$sex == "male", ],
                nper, labb)
@



Concerning the social pattern, we find somewhat different results from that of the younger age group of women. Cardiovascular mortality among elderly women do not present a consistent class pattern. Female cardiovascular mortality was somewhat higher among the elite and the middle group than among working class women until the last decades. Elderly from a working class background were not disadvantaged for most of the 20th century. The social class pattern has changed somewhat during the last periods and more in line to what is expected. The differences are however rather small. 


Even if results for elderly men point in different directions for some periods, the general trend resembles that of working-active men. The highest class had high cardiovascular mortality during the first half of the 20th century, while the expected social pattern has developed only during the most recent periods.  


<<41cumswold, fig.cap = cap22, fig.scap = scap22, fig.height = 8>>=
##source("R/plotED.R")
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "H(90|65)",  main = "Women 65-89", exclude = 3:4)
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "H(90|65)", main = "Men 65-89")
par(oldpar)
@

<<41cumswoldtab,results='asis'>>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex * period *hisclass,
                ##sex * period + hisclass * period, 
            data = cvb6589, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:41cumswoldtab", caption = "Anova, cardiovascular deaths, 65-90.")
@

See Table~\ref{tab:41cumswoldtab}.

% \subsubsection{The effect of income and education on cardiovascular death, 1990--2005}
% 
% The analysis of cardiovascular mortality for the period 1990--2005 is in this section based on a separate analysis with
% income and education as explanatory variables. The statistical significance of the covariates are shown in Table~\ref{tab:41liswom2} for women and Table~\ref{tab:41lismen2} for men. It confirms that most of the variables are strongly significant except
% 
% <<41lissyoung2>>=
% library(eha)
% library(xtable)
% ##load("data/loTab.rda")
% ##loTab$period <- factor(loTab$period)
% liss6589 <- loTab[loTab$age > 64.5, ]
% @
% 
% 
% 
% <<41liswom2, results = 'asis'>>=
% fitw2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "female", ])
% ##cat("Women:\n")
% drw2 <- drop1(fitw2, test = "Chisq")
% xtable(drw2, caption = "Effect of covariates for women 65-89, 1990-2005, cardiovascular death.", label = "tab:41liswom2")
% ##round(summary(fitw1)$coef[-(1:13), ], 4)
% @
% 
% 
% <<41lismen2, results='asis'>>=
% fitm2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "male", ])
% ##cat("\nMen:\n")
% drm2 <- drop1(fitm2, test = "Chisq")
% xtable(drm2, caption = "Effect of covariates for men 65-89, 1990-2005, cardiovascular death.", label = "tab:41lismen2")
% ##round(summary(fitm1)$coef[-(1:13), ], 4)
% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% @
% 
% The estimated effect sizes are shown in Figure \ref{fig:liswomfig}
% 
% <<41liswomfig2, fig.cap = "Effect sizes, women 65-89, 1990-2005, cardiovascular death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitw2)
% @
% 
% 
% And for men:
% 
% 
% 
% <<41lismanfig2, fig.cap = "Effect sizes, men 65-89, 1990-2005, cardiovascular death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitm2)
% @
% 
% The pattern is similar to what we find for all-cause mortality. The higher educational level, the lower cardiovascular mortality, and more income leads to better survival. This association is clear and consistent for women as well as for men. A minor difference between men and women is that mortality in the higher levels of education do not lead to lower mortality among women while that is the case among men.

\subsection{Cancer mortality}

While we assume clear social differences in cardiovascular diseases, this is not necessarily an obvious assumption when it comes to cancers. Different forms of cancers have very different origin and different pathways to disease and death. The social pattern of higher mortality in classes with less power and accordingly less life chances are considered to be less clear when it comes to cancers. In our analyses, there is a risk that cancer mortality is under-estimated during the first half of the 20th century, illustrated by the already mentioned large proportion of unknown or vague causes at that time. We believe however that cancers were better diagnosed than cardiovascular deaths. This is supported by the stability in proportion of cancer deaths between the two first periods, 12.5 per cent 1901--1925 and 13.5 per cent for the period 1926--1950.

<<causes12>>=
cvb <- vb0
cvb$event <- cvb$cancer ## Can this be done better?
cvb <- cvb[!(cvb$period %in% c("1851-1875", "1876-1900")), ]
cvb$period <- factor(cvb$period)

# load("data/vb.rda")
# ##vb <- cal.window(vb, c(1961, 2001))
# ##x <- substr(vb$ULORSAK, 1, 2)
# vb$event <- vb$event & vb$heart
# vb$exposure <- with(vb, exit - enter)
# vb$cohort <- factor(vb$cohort)
# vb$period <- factor(vb$period)
cvbTab <- aggregate(cvb[, c("event", "exposure")],
                    cvb[, c("sex", "age", "period", "cohort",
                           "urban", "civst", "hisclass")],
                    FUN = sum)
 cvbTab$hisclass <- factor(cvbTab$hisclass)
 cvbTab$age <- factor(cvbTab$age)
@

<<12colorc>>=
## Colours for plotting strata:
scol <- c("blue", rep("darkgreen", 2), "red")
## Common for all groups:

labb <- levels(cvbTab$period)
nper <- length(labb)
source("R/getPHglm.R")
## End 'common'
@

We use similar types of analyses as in the earlier sections. The cumulative
hazards at the end of the period (65 if 40--64, 90 if 65--89) are the
main target in our analysis. These numbers are used in the process of
graphically illustrating the development over time.

%creating an \emph{heterogeneity index} (a better name is needed:
%\emph{health disparity index}, \emph{Social Inequality Mortality Index, (SIMI)}?
%Something catchy.).

\subsubsection{Ages 40--64}

%The distribution over time periods.
<<12getske4060>>=
cap1w <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, women, cancer death."
scap1w <-  "Cumulative hazards, ages 40--64, women, cancer death."
cap1m <-  "Cumulative hazards for HISCLASS by time period, ages 40--64, men, cancer death."
scap1m <-  "Cumulative hazards, ages 40--64, men, cancer death."
##
cap12 <- "Total hazard of dying before age 65 for a 40 year old person standardised by HISCLASS and decade, women (top) and men (bottom), cancer death."
scap12 <- "Total hazard by HISCLASS, ages 40--64, cancer death."
cap12log <- "Total hazard of dying before age 65 for a 40 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades, cancer death."
scap12log <- "Total hazard by HISCLASS, ages 40--64, last years, cancer death."

cap2w <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, women, cancer death."
scap2w <-  "Cumulative hazards, ages 65--89, women, cancer death."
cap2m <-  "Cumulative hazards for HISCLASS by time period, ages 65--89, men, cancer death."
scap2m <-  "Cumulative hazards, ages 65--89, men, cancer death."
##
cap22 <- "Total hazard of dying before age 90 for a 65 year old person standardised by HISCLASS and decade, women (top) and men (bottom), cancer death."
scap22 <- "Total hazard standardised by HISCLASS, ages 65--89, cancer death."
cap22log <- "Total hazard of dying before age 90 for a 65 year old person by HISCLASS and decade, women (top) and men (bottom). The last decades, cancer death."
scap22log <- "Total hazard by HISCLASS, ages 65--89, last years, cancer death."

##
cvb4064 <- cvbTab[as.numeric(as.character(cvbTab$age)) < 64.5, ]
cvb4064$age <- factor(cvb4064$age)
@


<<12hazcalw>>=
source("R/getPHglm2.R")
resw <- getPHglm2(cvb4064[cvb4064$sex == "female", ],
            nper, labb)
resm <- getPHglm2(cvb4064[cvb4064$sex == "male", ],
            nper, labb)
@


%%We will use as a summary measure the value of the cumulative hazards at
%%age 65, given survival to age 40.

<<12cumsw, fig.cap = cap12, fig.scap = scap12, fig.height = 8>>=
source("R/plotED.glm.R")
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE, exclude = 3:4,
                    ylab = "TMR(65|40)",  main = "Women 40-64")
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE, ##exclude = 1:2,
                    ylab = "TMR(65|40)", main = "Men 40-64")
par(oldpar)
@

%%<<cumsm, fig.cap = "Total haz of deaths in ages 40--64 per individual by HISCLASS and decade, men.">>=
%%@

<<12cumswtab,results='asis'>>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex *hisclass +
                sex * period + hisclass * period, 
            data = cvb4064, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:12cumswtab", caption = "Anova, cancer deaths, 40-64.")
@

See Table~\ref{tab:12cumswtab}.

Figure~\ref{fig:12cumsw} shows relative mortality levels according to {\sc Hisclass} during the different studied periods for the age group 40--64. Cancer mortality among the élite women was lower than that for the other classes during the complete studied period, while working class women had the highest levels during almost all periods. Consequently, we find a more consistent advantage of higher class in cancers compared to cardiovascular diseases for women. We do however not find the same pattern for men. It is difficult to identify any general features of 20th century male cancer mortality when it comes to social differences. 

%% HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH

% \subsubsection{The effect of income and education on cancer mortality, 1990--2005}
% 
% In the previous section, we concluded that there were no social inequality in cancer mortality according to hisclass. The question here is if the lacking socio-economic differentiation holds also when using education and income as categorising variables. The analysis for the period 1990--2005 is based on a separate analysis with income and education as explanatory variables.
% 
% <<12lissyoung>>=
% library(eha)
% library(xtable)
% ##load("data/loTab.rda")
% ##loTab$period <- factor(loTab$period)
% liss4064 <- loTab[loTab$age < 64.5, ]
% @
% 
% 
% The statistical significance of the covariates are shown in Table~\ref{tab:12liswom} for women and Table~\ref{tab:12lismen} for men. The variables of interest here are all significant.
% <<12liswom, results = 'asis'>>=
% fitw1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "female", ])
% ##cat("Women:\n")
% drw <- drop1(fitw1, test = "Chisq")
% xtable(drw, caption = "Effect of covariates for women 40-64, 1990-2005, cancer death.", label = "tab:12liswom")
% ##round(summary(fitw1)$coef[-(1:13), ], 4)
% @
% 
% <<12lismen, results='asis'>>=
% fitm1 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss4064[liss4064$sex == "male", ])
% ##cat("\nMen:\n")
% drm <- drop1(fitm1, test = "Chisq")
% xtable(drm, caption = "Effect of covariates for men 40-64, 1990-2005, cancer death.", label = "tab:12lismen")
% ##round(summary(fitm1)$coef[-(1:13), ], 4)
% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% @
% 
% The estimated effect sizes are shown in Figure \ref{fig:12liswomfig}.
% 
% <<12liswomfig, fig.cap = "Effect sizes, women 40-64, 1990-2005, cancer death.", fig.height = 4>>=
% source("R/plotWEduc.R")
% plotWEduc(fitw1)
% @
% 
% 
% And for men:
% 
% 
% <<12lismanfig, fig.cap = "Effect sizes, men 40-64, 1990-2005, cancer death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitm1)
% @
% 
% 
% <<12plotliss1, fig.cap = "Cumulative hazards, ages 40--64, 2002--2013, cancer death.", fig.height = 4>>=
% #oldpar <- par(mfrow = c(1, 2))
% #plot(fitw1, fn = "cum", col = dcol, main = "Women")
% #plot(fitm1, fn = "cum", col = dcol, main = "Men")
% #par(oldpar)
% ##summary(fitw1)
% ##summary(fitm1)
% @
% 
% %See Table~\ref{tab:tablisswom1} the PH regression for women.
% <<12tablisswom1, results = "asis">>=
% #fitwo1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% #                 data = liss4064[liss4064$sex == "female", ])
% #dr <- drop1(fitwo1, test = "Chisq")
% #ltx(fitwo1, dr = dr, caption = "PH regression, women aged 40--64, 2002--2013.",
% #    label = "tab:tablisswom1")
% @
% 
% %See Table~\ref{tab:tablissman1} the PH regression for men.
% <<12tablissman1, results = "asis">>=
% #fitma1 <- coxreg(Surv(enter, exit, event) ~ DISPINK + CIV + SUN2000NIVA,
% #                 data = liss4064[liss4064$sex == "male", ])
% #dr <- drop1(fitma1, test = "Chisq")
% #ltx(fitma1, dr = dr, caption = "PH regression, men aged 40--64, 2002--2013.",
%  #   label = "tab:tablissman1")
% @
% 
% When it comes to the association with education and income, we find the similar pattern as those for all-cause mortality and cardiovascular mortality. There is a strong effect for both men and women of having more education and income. These variables seem to catch up important aspect of socio-economic differences in health and mortality.

\subsubsection{Ages 65--89}

%The distribution over time periods.
<<12getske6089>>=
cvb6589 <- cvbTab[as.numeric(as.character(cvbTab$age)) >= 64.5, ]
cvb6589$age <- factor(cvb6589$age) # NOTE:: Now change to '6589'!
@

In our analyses of class patterns in mortality, we finally turn to cancer mortality among the elderly. 

%\subsubsection{Women}

<<12hazcalwold>>=
resw <- getPHglm2(cvb6589[cvb6589$sex == "female", ],
              nper, labb)
resm <- getPHglm2(cvb6589[cvb6589$sex == "male", ],
                nper, labb)
@




The relation between different classes and cancer mortality fluctuates considerably both for women and men in this age group. For some periods it has to do with quite few events to analyse. Women of the highest class have favourable mortality during several periods, consistent with the advantages we found for women in the younger age group, but on the other hand had high levels at other times. The social differences are however quite small during the most recent periods. 

For men we find a similar lack of social pattern in cancer mortality as we found for men in working-active ages. There is however a tendency during the last decades of higher mortality among working class men.

<<12cumswold, fig.cap = cap22, fig.scap = scap22, fig.height = 8>>=
##source("R/plotED.R")
oldpar <- par(mfrow = c(2, 1))
woutp <- plotED.glm(resw, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(90|65)",  main = "Women 65-89", exclude = 3:4)
moutp <- plotED.glm(resm, col = scol, logScale = FALSE, relative = TRUE,
                    ylab = "TMR(90|65)", main = "Men 65-89")
par(oldpar)
@

<<12cumswoldtab,results='asis'>>=
fitt <- glm(event ~ offset(log(exposure)) + urban + civst + age + sex +
                sex * period + hisclass * period, 
            data = cvb6589, family = poisson)
dr <- drop1(fitt, test = "Chisq")
##knitr::kable(dr)
xtable(dr,label = "tab:12cumswoldtab", caption = "Anova, cancer deaths, 65-90.")
@

See Table~\ref{tab:12cumswoldtab}.
% \subsubsection{The effect of income and education on cancer death, 1990--2005}
% 
% Thus, we find indications of social differences in the later decades, particularly between the elite and the workers. The alternative analysis for the last period is based on a separate analysis with
% income and education as explanatory variables.
% 
% <<12lissyoung2>>=
% library(eha)
% library(xtable)
% ##load("data/loTab.rda")
% ##loTab$period <- factor(loTab$period)
% liss6589 <- loTab[loTab$age > 64.5, ]
% @
% 
% 
% The statistical significance of the covariates are shown in Table~\ref{tab:12liswom2} for women and Table~\ref{tab:12lismen2} for men.
% <<12liswom2, results = 'asis'>>=
% fitw2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "female", ])
% ##cat("Women:\n")
% drw2 <- drop1(fitw2, test = "Chisq")
% xtable(drw2, caption = "Effect of covariates for women 65-89, 1990-2005, cancer death.", label = "tab:12liswom2")
% ##round(summary(fitw1)$coef[-(1:13), ], 4)
% @
% 
% <<12lismen2, results='asis'>>=
% fitm2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = poisson, data = liss6589[liss6589$sex == "male", ])
% ##cat("\nMen:\n")
% drm2 <- drop1(fitm2, test = "Chisq")
% xtable(drm2, caption = "Effect of covariates for men 65-89, 1990-2005, cancer death.", label = "tab:12lismen2")
% ##round(summary(fitm1)$coef[-(1:13), ], 4)
% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% @
% 
% The estimated effect sizes are shown in Figure \ref{fig:12liswomfig2}
% 
% <<12liswomfig2, fig.cap = "Effect sizes, women 65-89, 1990-2005, cancer death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitw2)
% @
% 
% 
% And for men:
% 
% %% <<12lismen2, results='asis'>>=
% %% fitm2 <- glm(event ~ offset(log(exposure)) + as.factor(age) + urban + period + civst + income + educ, family = ##poisson, data = liss6589[liss6589$sex == "male", ])
% %% ##cat("\nMen:\n")
% %% drm2 <- drop1(fitm2, test = "Chisq")
% %% xtable(drm2, caption = "Effect of covariates for men 65-89, 1990-2005, cancer death.")
% %% round(summary(fitm1)$coef[-(1:13), ], 4)
% %% dcol <- c("blue", "darkgreen", "darkgreen", "red")
% %% @
% 
% <<12lismanfig2, fig.cap = "Effect sizes, men 65-89, 1990-2005, cancer death.", fig.height = 4>>=
% #source("R/plotWEduc.R")
% plotWEduc(fitm2)
% @
% 
% The social inequality in cancer mortality is confirmed by the approach of analysing the effect of education and income. We find the same consistent pattern as we have found for all-cause mortality and cardiovascular mortality for this period. Higher levels of education and more income is associated with lower cancer mortality. We can therefore conclude that both education and income are strongly decisive aspects of social differentiation when it comes to mortality during the last decades.

%%{\huge Här ska 'conclusion.tex' in !!!}

\section{The effect of Education, 1990--2013}

%\subsection{All causes of death}

A common alternative to a class analysis is to use income or education for investigating socio-economic health differences. \citet{goldk10} criticize how many economists and epidemiologists operationalize inequality in their studies, for example by not distinguishing between class and status aspects. Class refers to relational aspects in society, while many other variables focus on the distribution of material and/or immaterial resources. He advocates studies of different aspects, which together complement each other. Comparing different approaches are valuable in order to understand why some are advantaged and others disadvantaged and what sort of factors determines health differences. In this and the following section, we introduce analyses of education and income. In that way, we can compare the class analyses with these alternative categorizations. For the time being, we have to restrict such a comparative analysis to the last decades.

In this section we analyse differences according to education level for the period 1990--2013 for the whole population 40 years and older. Education is a good indicator of both human and cultural capital, but aer also strongly associated with income and social class. We present analyses on all cause mortality (survival curves) as well as on the cause of death groups of cardiovascular diseases and cancers (cumulative hazards). The pattern is clear in total mortality as well as cause specific mortality, and this is valid for both men and women, see Figures~\ref{fig:ploteduc},~\ref{fig:ploteducheart} and~\ref{fig:ploteduccancer}. Education had a strong, statistically significant, effect on survival, as expected. Those with the lowest education levels hade the highest mortality, while those with highest level of education had by far the best survival. The differences must be considered large, and it follows a continuous improvement according to increasing levels. 


<<lissyoung3>>=
library(eha)
library(xtable)
liss4064 <- loTab[loTab$age < 64.5, ]
con <- url("http://capa.ddb.umu.se/data/lisaold.rda")
##load("data/lisaold.rda")
load(con)
close(con)
@



<<educ>>=

educ <- lisaold[!(lisaold$period %in% c("1986-1987", "1988-1989")), ]
educ$period <- factor(educ$period)
educ <- educ[!is.na(educ$educ), ]
levels(educ$educ) <- c("low", "low", "middle", "middle", "middle", "high", "high")
##educ$educ <- relevel(educ$educ, ref = "middle")
educ$civst <- relevel(educ$civst, ref = "married")
fitm <- coxph(Surv(enter, exit, event) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "male", ])
fitf <- coxph(Surv(enter, exit, event) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "female", ])
cols <- c("red", "darkgreen", "black")
@

<<ploteduc, fig.cap="Survival by education and sex, 1990--2013.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), mark.time = FALSE, main = "Men",
     col = cols, lwd = 1.5, lty = c(1, 2, 5), axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
axis(1)
axis(2, at = c(0, 0.5, 1.0), las = 1)
abline(h = 0.5, lty = 3)
box()
legend("bottomleft", legend = levels(educ$educ), col = cols, lty = c(1, 2, 5), lwd = 1.5)

plot(survfit(fitf, start.time = 40), mark.time = FALSE, main = "Women",
     col = cols, lty = c(1, 2, 5), lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
axis(1)
axis(2, at = c(0, 0.5, 1.0), las = 1)
abline(h = 0.5, lty = 3)
box()
legend("bottomleft", legend = levels(educ$educ), col = cols, lty = c(1, 2, 5), lwd = 1.5)

par(oldpar)
@

<<tableeduc,results='asis'>>=
fit <- coxreg(Surv(enter, exit, event) ~ educ + civst + urban + sex, data = educ[!is.na(educ$civst), ], 
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
ltx(fit, dr = dr, caption = "Effect of education on mortality in ages 40-90, 1990-2013.", 
    label = "tab:tableeduc", digits = 4)
@

See Table~\ref{tab:tableeduc}.


%\subsection{Cardiovascular death}

<<cardeduc>>=
ulcard <- unique(vb0$ULORSAK[vb0$heart])
educ$heart <- FALSE
educ$heart <- !is.na(educ$ULORSAK) & (educ$ULORSAK %in% ulcard) & educ$event
fitm <- coxph(Surv(enter, exit, heart) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "male", ])
fitf <- coxph(Surv(enter, exit, heart) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "female", ])
@

% Illustrating differences for cause-specific mortality is conveniently done by comparing 
% cumulative hazards, see Figure~\ref{fig:ploteducheart}, where educational effects on 
% cardiovascular mortality is illustrated. The pattern is exactly the same as for total 
% mortality.

<<ploteducheart, fig.cap="Cumulative hazards by education and sex, cardiovascular death, 1990--2013.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Men",
     col = cols, lty = c(1, 2, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.9))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(educ$educ), col = cols, lty = c(1, 2, 5), lwd = 1.5)
abline(h = 0)
plot(survfit(fitf, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Women",
     col = cols, lty = c(1:2, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.9))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(educ$educ), col = cols, lty = c(1:2, 5), lwd = 1.5)
abline(h = 0)
par(oldpar)
@

<<tableeducheart,results='asis'>>=
fit <- coxreg(Surv(enter, exit, heart) ~ educ + civst + urban + sex, data = educ[!is.na(educ$civst), ], 
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
ltx(fit, dr = dr, caption = "Effect of education on cardiovascular mortality in ages 40-90, 1990-2013.", 
    label = "tab:tableeducheart", digits = 4)
@

See Table~\ref{tab:tableeducheart}.

%\subsection{Cancer death}

<<canceduc>>=
ulcard <- unique(vb0$ULORSAK[vb0$cancer])
educ$cancer <- FALSE
educ$cancer <- !is.na(educ$ULORSAK) & (educ$ULORSAK %in% ulcard) & educ$event
fitm <- coxph(Surv(enter, exit, cancer) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "male", ])
fitf <- coxph(Surv(enter, exit, cancer) ~ strata(educ) + civst + urban,
             data = educ[educ$sex == "female", ])
@

% Although mortality in cancer is lower than mortality in cardiovascular diseases,
% the pattern is the same: The more education, the less mortality. See 
% Figure~\ref{fig:ploteduccancer}.

<<ploteduccancer, fig.cap="Cumulative hazards by education and sex, cancer death, 1990--2013.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Men",
     col = cols, lty = c(1, 2, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(educ$educ), col = cols, lty = c(1, 2, 5), lwd = 1.5)
abline(h = 0)
plot(survfit(fitf, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Women",
     col = cols, lty = c(1, 2, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(educ$educ), col = cols, lty = c(1, 2, 5), lwd = 1.5)
abline(h = 0)
par(oldpar)
@

<<tableeduccancer,results='asis'>>=
fit <- coxreg(Surv(enter, exit, cancer) ~ educ + civst + urban + sex, data = educ[!is.na(educ$civst), ], 
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
ltx(fit, dr = dr, caption = "Effect of education on cancer mortality in ages 40-89, 1990-2013.", 
    label = "tab:tableeduccancer", digits = 4)
@

See Table~\ref{tab:tableeduccancer}.

\section{The effect of Income, 1986--2005}

%\subsection{All causes of death}


<<femeduc>>=
income <- lisaold[!is.na(lisaold$income), ]
income$period <- factor(income$period)
##income <- income[!is.na(income$income), ]
##levels(income$income) <- c("low", "low", "middle", "middle", "middle", "high", "high")
##income$income <- relevel(income$income, ref = "low")
income$civst <- relevel(income$civst, ref = "married")
fitm <- coxph(Surv(enter, exit, event) ~ strata(income) + civst + urban,
             data = income[income$sex == "male", ])
fitf <- coxph(Surv(enter, exit, event) ~ strata(income) + civst + urban,
             data = income[income$sex == "female", ])
cols <- c("darkgreen", "red", "blue", "black")

@

<<plotincome, fig.cap="Survival by income and sex, 1986--2005.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), mark.time = FALSE, main = "Men",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
axis(1)
axis(2, at = c(0, 0.5, 1.0), las = 1)
abline(h = 0.5, lty = 3)
box()
legend("bottomleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)

plot(survfit(fitf, start.time = 40), mark.time = FALSE, main = "Women",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, axes = FALSE, xlab = "Age", ylab = "Surviving fraction")
axis(1)
axis(2, at = c(0, 0.5, 1.0), las = 1)
abline(h = 0.5, lty = 3)
box()
legend("bottomleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)

par(oldpar)
@

<<tableinc>>=
fit <- coxreg(Surv(enter, exit, event) ~ income + civst + urban + sex, data = income[!is.na(income$civst), ],
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
@

<<tableincpr,results='asis'>>=
ltx(fit, dr = dr, caption = "Effect of income on mortality in ages 40-89, 1986-2005.", 
    label = "tab:tableincpr", digits = 4)
@

See Table~\ref{tab:tableincpr}.

Finally, we present analyses of different income levels for the age group 40 and above and the period 1986--2005. Disposable individual income must be considered as a robust measure of economic condition, and increases the possibility to allocate these economic resources towards health promoting living conditions and behaviours. We categorize the income according to quartiles. As expected, we find that higher incomes result in lower mortality, both when it comes to total mortality as to deaths from cardiovascular diseases, see Figures~\ref{fig:plotincome} and~\ref{fig:plotincheart}. This is also what could be expected, and conforms to what we know of social health differences in present-day Sweden. We also find indications of a similar difference for cancers but less clear, particularly for male cancer mortality, see Figure~\ref{fig:plotinccancer}. Notice however that we cannot establish a causal relationship between income and mortality. Bad health may be a confounder, causing both low incomes and higher death risks.


%\subsection{Cardiovascular death}

<<heartincome>>=
ulcard <- unique(vb0$ULORSAK[vb0$heart])
income$heart <- FALSE
income$heart <- !is.na(income$ULORSAK) & (income$ULORSAK %in% ulcard) & income$event
fitm <- coxph(Surv(enter, exit, heart) ~ strata(income) + civst + urban,
             data = income[income$sex == "male", ])
fitf <- coxph(Surv(enter, exit, heart) ~ strata(income) + civst + urban,
             data = income[income$sex == "female", ])

@

%The overall pattern is the same for cardiovascular mortality, high income pays off.
<<plotincheart, fig.cap="Cumulative hazards by income and sex, cardiovascular death, 1986-2005.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Men",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 1.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)
abline(h = 0)
plot(survfit(fitf, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Women",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 1.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)
abline(h = 0)
par(oldpar)
@

<<tableincheart>>=
fit <- coxreg(Surv(enter, exit, heart) ~ income + civst + urban + sex, data = income[!is.na(income$civst), ],
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
@

<<tableincprheart,results='asis'>>=
ltx(fit, dr = dr, caption = "Effect of income on cardiovascular mortality in ages 40-89, 1986-2005.", 
    label = "tab:tableincprheart", digits = 4)
@

See Table~\ref{tab:tableincprheart} for the effect of income on cardiovascular death.

%\subsection{Cancer death}

<<cancerincome>>=
ulcard <- unique(vb0$ULORSAK[vb0$cancer])
income$cancer <- FALSE
income$cancer <- !is.na(income$ULORSAK) & (income$ULORSAK %in% ulcard) & income$event
fitm <- coxph(Surv(enter, exit, cancer) ~ strata(income) + civst + urban,
             data = income[income$sex == "male", ])
fitf <- coxph(Surv(enter, exit, cancer) ~ strata(income) + civst + urban,
             data = income[income$sex == "female", ])

@

% The same goes for cancer mortality, but the relative differences are smaller. See Figure~\ref{fig:plotinccancer}.

<<plotinccancer, fig.cap="Cumulative hazards by income and sex, cancer death, 1990--2013.">>=
oldpar <- par(mfrow = c(1, 2))

plot(survfit(fitm, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Men",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)
abline(h = 0)
plot(survfit(fitf, start.time = 40), fun = "cumhaz", mark.time = FALSE, main = "Women",
     col = cols, lty = c(1, 2, 4, 5), lwd = 1.5, xlab = "Age", ylab = "Cumulative hazards", ylim = c(0, 0.5))
#axis(1)
#axis(2, at = c(0, 0.5, 1.0), las = 1)
#abline(h = 0.5, lty = 3)
#box()
legend("topleft", legend = levels(income$income), col = cols, lty = c(1, 2, 4, 5), lwd = 1.5)
abline(h = 0)
par(oldpar)
@

<<tableinccancer>>=
fit <- coxreg(Surv(enter, exit, heart) ~ income + civst + urban + sex, data = income[!is.na(income$civst), ],
              hazards = FALSE)
dr <- drop1(fit, test = "Chisq")
@

<<tableincprcancer,results='asis'>>=
ltx(fit, dr = dr, caption = "Effect of income on cancer mortality in ages 40-89, 1986-2005.", 
    label = "tab:tableincprcancer", digits = 4)
@

See Table~\ref{tab:tableincprcancer} for the income effect on cancer death.


\section{Discussion}


The authors of this paper have scrutinised different aspects of the social
pattern of mortality in historical northern Sweden for some time, focusing on
different regions, different age groups and different time periods \citep{edv92, edv04, edli11, edbr12}. When it comes to infant and child mortality pre---and 
early---transitional time, the expected socio-economic differences was often but not always confirmed \citep{edv92, edv04}, something that has been found in other studies as well \citep{bredro02, bube01, mol17}. Studies based on microdata on the adult population in history have been rare, mainly due to lack of adequate data. The results from such studies show other patterns than that of infant and child mortality. The expected social gradient in
survival, meaning that people from higher social classes always had an
advantage, was in many cases, particularly among adult men, not found
despite the well-documented socio-economic differences \citep{edli11, edbr12}. There were however large differences between men and women and for different age groups. These earlier studies have suggested that distinct and consistent differences to the advantage of higher classes developed somewhere during and probably quite early in the 20th century \citep{bevp11}. Until now we have however not been able to investigate the continuous development on mortality differences among the adult and elderly
population due to no available data. This is the first time it has been possible, and the results continue to surprise us. The consistent advantage for higher social classes do not appear until quite late in the regions we have analysed. The social pattern of female mortality are in line to what is
expected, but a social gradient in male adult mortality seems to be a recent phenomenon. Furthermore, this transition and the class pattern of mortality differ depending on age group. Inequality in mortality appear clearer for the population at working age, while the differences are smaller among the elderly.

The results of small socio-economic gradient in the past and its late development are however in accordance with other studies \citep{bevp11}, for example by \citet{bedr11} in a very different setting, a couple of Scanian parishes, although with somewhat different social categories. They found the first indications of an emerging social gradient in the 1950s. Similar results have also been found in Estonia \citep{Jaadla17}.

When it comes to specific causes of death, the analysis shows that cardiovascular diseases contributes to a large proportion of all deaths during the 20th century, and we are not surprised that it has a fairly similar pattern as for all-cause mortality. Cancer is sometimes considered less connected to social class, and we find mixed results in our analyses. 

The surprising results makes it reasonable to consider the
validity and possible weaknesses in the study. One obstacle concerns the quality of available information. Occupational titles in historical sources are not always distinct enough to define the correct class. It can be difficult to identify the skill level in the working class population because many
were often only designated as labourer. The size of the enterprise for free
entrepreneurs is unknown and it may be impossible to distinguish if they
are self-employed or have employees. The class system and the position
of different classes can also be discussed. Studies covering long period
have the problem that occupations and classes change character - they do
not represent the same thing. Nevertheless, these ambiguities and possible
mis-classifications are not of that sort and magnitude that it would radically change
the basic patterns observed. The social classes identified during the
different periods represent distinct groups with very large differences in
resources, capacities and power. Available data, for example from the 1930 census confirm that class differences in income and wealth were large, often enormous.


In this paper we have analysed social inequality in health from the
perspective of social classes using {\sc Hisclass}. However, there are
alternative ways to analyse social inequality, and we cannot exclude that
such analyses gives other results or at least would modify the image
presented here. In many modern studies categorisations based on income, wealth
or education are common for studies of inequality. They represent different dimensions of 
inequality. One problem is however that reliable data on income and
education are rarely available in historical population databases. 
As a test, we have included analyses of the associations of
education and income to mortality for recent decades. For women as
well as for men, for both age groups and for all-cause mortality as well as
cause-specific mortality we find consistent differences with higher
educational level and more income leading to lower mortality, thus basically confirming what we find in the class analysis. We do not know if education and income are equally important in the past.




The WHO Commission on Social Determinants of Health framework for the social determinants of health provides a model on how socio-economic position influence health. Social class works through intermediate determinants related to exposure and vulnerability \citep{who10}. People are situated within socio-economic and political contexts, as well as prevailing value systems in society. Socio-economic position imply different access to resources, power and prestige, all being aspects of crucial importance. The framework takes a holistic approach to the social determinants, including not only the effect of pure economic and material resources. The importance of understanding people in their context is also emphasised by for example \citet{kri05}. What she calls embodiment refers to the recognition that human beings are simultaneously social beings and biological organisms. The WHO framework 
\citep{who10} lists three different types of intermediary social determinants of health; material circumstances, behaviours, biological factors, and finally psycho-social factors. Most studies focus on material circumstances. Having a good economy gives advantages in many aspects of relevance for health and mortality, for example good living conditions, access to food, medical care and better working conditions. Even though these advantages were at hand in our studied regions, the final result was not better health for men in the most privileged groups until the late 20th century. We must therefore consider other explanations. Psycho-social factors have been frequently discussed during the most recent decades, for example by \citet{mar04}, who argues that a higher status leads to better health, regardless of where in the status ladder we make our observations. Psychosocial factors are also suggested by \citet{wipi09} as an explanation why equal societies always perform better than unequal ones when it comes to health and other social conditions. In the case studied here, we do not find any indication of a status syndrome, since mortality levels was in the opposite directions to the one we would expect from these theories.

This makes us consider the possible impact of behavioural factors. Our results of the gender aspect might be of interest in this case. When it comes to gender differences, the present study confirms what we previously have found in the Sundsvall region \citep{edli11}. There is a clear gendered pattern when it comes to social inequality in mortality.  Within the same households, the effect of social class seems to lead to different results, high social position being beneficial for women but not for men. We might consider the role of behaviours based on different gendered expectations. Having a high social status could be expressed in attitudes and behaviours that were harmful for health (this is discussed in more detail in \citet{edli11}. Alcohol has been suggested as part of the large gender differences in the 19th century \citep{wil99, edv92}, and a more risk-taking life may be a component of male mortality \citep{cour00}. There are however some problems with attributing most of the male excess mortality to heavy drinking. Alcohol consumption decreased substantially during the period late 19th century to the 1950s, but the old pattern in social health inequalities remained. Swedes at that time had very low consumption levels. Alternative explanations should also be considered. There
were strong and heavy requirements of being successful for the male \"elite. Many were involved in businesses with high risks and they may have felt a constant threat of economic failure. 


Our study illustrates the importance of considering contextual factors and
the restrictions of making general statements. We need to look into all
aspects of social classes, not only the material ones but also what this
means for behaviour, norms, way of living. \citet{edli11} suggest that an
explanation for the larger social health inequalities in present-day
society is that high status is expressed through health, being fit and physically active, while in many historical contexts higher social status (for men) was expressed in low physical activity, obsessive
eating, drinking, smoking and sometimes also taking risks.  Different historical contexts promote different ways to spend economic resources.This is also in line with what \citet{rasp06} and \citet{Jaadla17} suggest. If this interpretation is correct, the hypothesis of \citet{ant67}on an increasing role of health related behaviour in the modern low-mortality régime,while economic inequality determined the social mortality pattern during the early phases of the mortality transition. Instead, health-related seems to be at least equally strong earlier in history but having a completely different expression. 

One of the major findings in this study relate to gender. As several researchers have pointed out, demography has often ignored power relations and different roles within families \citep{watkins93, mack95, jans07}. By investigating possible differences in mortality patterns according to sex, we have identified gendered patterns within the family. Different patterns between the sexes may be caused by discrimination on the female part in the household. We know that the society was
strongly segregated according to gender and that women were discriminated
and had less space for action. In our case, we do not find this to have negative consequences for women, indicating that the relation between sexes in the society was characterised by distinct gendered expectations on behaviour. 

Another question is if our results can be generalised to other historical contexts. We have studied
environments in northern Sweden without any large metropolis. Perhaps
Sweden and/or this part of Sweden is a special case. The social differences
may have been smaller, the involvement of government both at the national
and local level may have been stronger, thus mitigating socio-economic
disadvantages. In comparison with many other countries, the level of mortality has been fairly low. These are relevant questions, which hopefully can be
addressed in other and maybe comparative studies.

Finally, we argue that our results have implications for the understanding
on several other hot research topics. A central and hot debated question concerning the mortality
transition is how the enormous increase in survival was accomplished. \citet{mck76} argues that the
improvements up to the middle of the 20th century was primarily caused by improved nutrition. This implicate that having more resources would lead to better survival. If research shows that the most
advantaged groups did not have better health and longer lives, this do not
necessarily speak against McKeown's ideas but it makes the question more
complex. The results are also difficult to fit into \citet{liph95}
hypothesis that social conditions should be seen as a fundamental cause of
disease and not only expressions of different disadvantages. In the historical
context analysed here, this idea is not supported. 

In recent years, the question about the relation between health and income
inequality been widely discussed \citep{wipi09}. Even though our study do not address this
issue directly, our results are of interest for this question as well. The
development of the social inequality in mortality do not seem to fit that
well into the development of income and wealth inequalities. The early 20th
century, in Sweden as well as in other countries, was characterised by very
large economic differences, still this did in our regions not lead to any
consistent advantage for the highest social classes. After the Second World
War, economic differences diminished, and was at its lowest in Sweden at
about 1980, i.e. at a time when a more expected pattern of a social
hierarchy in survival had appeared. The period thereafter is characterised
by increasing economic differences, and this may coincide with increasing
health differences as well. The long-term relation between economic
inequality and health is worth further studies.

% \section{Conclusion}
% 
% We started this paper by raising the issue of the development of social
% inequalities. When studying this question in history we often get surprised
% of its complexity. In a society characterised by large economic inequality,
% we would expect that this would result in corresponding mortality
% differences, i.e. higher social classes having an advantage. We find the
% appearance of a consistent social pattern in mortality, to the advantage of
% the higher classes, but surprisingly late in our history. It is only in the
% recent decades that this pattern dominates. Improved survival characterised
% however all HISCLASSes. We can however confirm that there are gender
% differences in the social pattern. While there is no clear social gradient
% among men, the results at least partly indicate advantages for the higher
% social classes for women already early in the 20th century. Females had
% more to gain from a high social position. Previous studies of the mortality
% transition have made similar observations. Among adults, gender has often
% been of more significant importance than social class. The reason for this
% difference and for the late appearance of the modern social pattern among
% men is still an enigma that require further studies, even though we have
% suggested the possible importance of behavioural factors and changes in
% ideals connected to different social classes. This should stimulate us to
% further disentangle the pathways for how social position influence health
% and mortality in different societies. Furthermore, we do not find any substantial differences or distinct pattern in the relation between class and the two major cause-of-death groups. Finally, we find stronger differences in the social pattern among the working-age population, while the associations were smaller or not so clear among the elderly. However, when analysing the association with education and income in the period 1990--2005 we find consistent patterns of higher income and higher education level being associated with lower mortality, indicating that these variables are better to catch socio-economic differences at least in the present-day society.

\section{Acknowledgements}

This work was undertaken within the Centre for Demographic and Ageing
Research (CEDAR) at Umeå University and with support from the Swedish
Research Council (VR) (grant No. 421-2012-892) and the project 
\emph{Old age, health, and inequality: Mortality from a life course perspective in Sweden 1986--2009}, 
 financed by the Swedish Research Council (grant No. 421-2012-892). We thank The Demographic Data
Base for giving us access to data and Jonas Helgertz, Department of
Economic History, Lund University, for providing us with scripts for
creating {\sc Hisclass} from Swedish Census data.


\bibliography{mybib}

\end{document}
@
